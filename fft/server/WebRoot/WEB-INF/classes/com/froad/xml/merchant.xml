<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="merchant" >

	<typeAlias alias="merchant" type="com.froad.CB.po.merchant.Merchant"/>
	<typeAlias alias="tagMap" type="com.froad.CB.po.tag.TagMAP"/>

  	<resultMap id="MerchantResult" class="merchant" >
    <result column="id" property="id" jdbcType="INTEGER" />
    <result column="id" property="merchantTrain" select="merchantTrain.selectByMerchantId"/>
    <result column="id" property="photoList" select="merchantPhotos.getMerchantPhotosByByMerchantId"/>
    <result column="id" property="productList" select="merchantProducts.selectByMerchantProductId"/>
    <result column="id" property="merchantPresent" select="merchantPresent.selectByMerchantId"/>
    <result column="id" property="tagMapList" select="tagMAP.selectTagsByMerchantId"/>
    <result column="id" property="storeList" select="store.selectByMerchantId"/>
    <result column="M_dc_hyperlink" property="dcHyperlink" jdbcType="VARCHAR" />
    <result column="M_company_full_name" property="companyFullName" jdbcType="VARCHAR" />
    <result column="M_company_short_name" property="companyShortName" jdbcType="VARCHAR" />
    <result column="M_company_Logo_url" property="companyLogoUrl" jdbcType="VARCHAR" />
    <result column="M_company_Logo_format" property="companyLogoFormat" jdbcType="VARCHAR" />
    <result column="M_company_address" property="companyAddress" jdbcType="VARCHAR" />
    <result column="M_company_zip" property="companyZip" jdbcType="VARCHAR" />
    <result column="M_company_fax" property="companyFax" jdbcType="VARCHAR" />
    <result column="M_company_Tel" property="companyTel" jdbcType="VARCHAR" />
    <result column="M_company_Legal_Name" property="companyLegalName" jdbcType="VARCHAR" />
    <result column="M_company_Legal_Credent_Type" property="companyLegalCredentType" jdbcType="VARCHAR" />
    <result column="M_company_Legal_Credent_No" property="companyLegalCredentNo" jdbcType="VARCHAR" />
    <result column="M_company_Contact_Name" property="companyContactName" jdbcType="VARCHAR" />
    <result column="M_company_Contact_Tel_1" property="companyContactTel1" jdbcType="VARCHAR" />
    <result column="M_company_Contact_Tel_2" property="companyContactTel2" jdbcType="VARCHAR" />
    <result column="M_company_Contact_Email" property="mcompanyContactEmail" jdbcType="VARCHAR" />
    <result column="M_store_full_name" property="mstoreFullName" jdbcType="VARCHAR" />
    <result column="M_store_short_name" property="mstoreShortName" jdbcType="VARCHAR" />
    <result column="M_store_Logo_url" property="mstoreLogoUrl" jdbcType="VARCHAR" />
    <result column="M_store_Logo_format" property="mstoreLogoFormat" jdbcType="VARCHAR" />
    <result column="M_store_address" property="mstoreAddress" jdbcType="VARCHAR" />
    <result column="M_store_zip" property="mstoreZip" jdbcType="VARCHAR" />
    <result column="M_store_fax" property="mstoreFax" jdbcType="VARCHAR" />
    <result column="M_store_Tel" property="mstoreTel" jdbcType="VARCHAR" />
    <result column="M_store_Contact_Name" property="mstoreContactName" jdbcType="VARCHAR" />
    <result column="M_store_Contact_Tel_1" property="mstoreContactTel1" jdbcType="VARCHAR" />
    <result column="M_store_Contact_Tel_2" property="mstoreContactTel2" jdbcType="VARCHAR" />
    <result column="M_store_Contact_Email" property="mstoreContactEmail" jdbcType="VARCHAR" />
    <result column="M_contract_begintime" property="mcontractBegintime" jdbcType="VARCHAR" />
    <result column="point_rate" property="pointRate" jdbcType="VARCHAR" />
    <result column="preferential_rate" property="preferentialRate" jdbcType="VARCHAR" />
    <result column="preferential_type" property="preferentialType" jdbcType="VARCHAR" />
    <result column="merchant_priority" property="merchantPriority" jdbcType="VARCHAR" />
    <result column="M_contract_endtime" property="mcontractEndtime" jdbcType="VARCHAR" />
    <result column="local_Station_id" property="localStationId" jdbcType="VARCHAR" />
    <result column="local_Bank_id" property="localBankId" jdbcType="VARCHAR" />
    <result column="M_contract_Staff" property="mcontractStaff" jdbcType="VARCHAR" />
    <result column="M_review_Staff" property="mreviewStaff" jdbcType="VARCHAR" />
    <result column="audit_staff" property="auditStaff" jdbcType="VARCHAR"/>
    <result column="state" property="state" jdbcType="VARCHAR" />
    <result column="create_time" property="createTime" jdbcType="VARCHAR" />
    <result column="update_time" property="updateTime" jdbcType="VARCHAR" />
    <result column="user_id" property="userId" jdbcType="VARCHAR" />
    <result column="remark" property="remark" jdbcType="VARCHAR" />

    <result column="is_internal_account" property="isInternalAccount" jdbcType="VARCHAR"/>
    <result column="business_license_url" property="businessLicenseUrl" jdbcType="VARCHAR"/>
    <result column="tax_registration_certificate_url" property="taxRegistrationCertificateUrl" jdbcType="VARCHAR"/>
    <result column="organization_code_certificate_url" property="organizationCodeCertificateUrl" jdbcType="VARCHAR"/>
    <result column="legal_idcard_url" property="legalIdcardUrl" jdbcType="VARCHAR"/>

    <result column="hot_level" property="hotLevel" jdbcType="VARCHAR"/>
    <result column="is_hot" property="isHot" jdbcType="VARCHAR"/>

  	<result column="client_img1" property="clientImg1" jdbcType="VARCHAR"/>
  	<result column="client_img2" property="clientImg2" jdbcType="VARCHAR"/>
  	<result column="preference_desc" property="preferenceDesc" jdbcType="VARCHAR"/>
  	<result column="activity_id" property="activityId" jdbcType="VARCHAR"/>

  	<result column="is_spring_activity" property="isSpringActivity" jdbcType="VARCHAR" />
    <result column="isaffordpresellflag" property="isAffordPresellFlag" jdbcType="VARCHAR" />
  </resultMap>

  <select id="getAllMerchant" resultMap="MerchantResult" parameterClass="merchant">
  	select * from merchant
	  <dynamic prepend="where">
	  	  <isNotEmpty prepend="and" property="id" >
        	id = #id#
      	  </isNotEmpty>
      	  <isNotEmpty prepend="and" property="hotLevel" >
        	hot_level = #hotLevel:VARCHAR#
     	   </isNotEmpty>
	      <isNotEmpty prepend="and" property="isHot" >
	        is_hot = #isHot:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyFullName" >
	       <![CDATA[  M_company_full_name like concat('%',#companyFullName#,'%')]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyShortName" >
	       <![CDATA[  M_company_short_name like concat('%',#companyShortName#,'%')]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyAddress" >
	       <![CDATA[  M_company_address like concat('%',#companyAddress#,'%')]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyZip" >
	        M_company_zip = #companyZip:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalName" >
	        M_company_Legal_Name = #companyLegalName:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalCredentType" >
	        M_company_Legal_Credent_Type = #companyLegalCredentType:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalCredentNo" >
	        M_company_Legal_Credent_No = #companyLegalCredentNo:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyContactName" >
	        M_company_Contact_Name = #companyContactName:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreFullName" >
	       <![CDATA[  M_store_full_name like concat('%',#mstoreFullName#,'%')]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreShortName" >
	      <![CDATA[   M_store_short_name like concat('%',#mstoreShortName#,'%')]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreAddress" >
	       <![CDATA[  M_store_address like concat('%',#mstoreAddress#,'%')]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreZip" >
	        M_store_zip = #mstoreZip:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreContactName" >
	        M_store_Contact_Name = #mstoreContactName:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractBegintime" >
	        M_contract_begintime = #mcontractBegintime:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="pointRate" >
	        point_rate= #pointRate:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="preferentialRate" >
	      	preferential_rate = #preferentialRate:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="preferentialType" >
	        preferential_type = #preferentialType:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="merchantPriority" >
	      	merchant_priority = #merchantPriority:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractEndtime" >
	        M_contract_endtime = #mcontractEndtime:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractStaff" >
	        M_contract_Staff = #mcontractStaff:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mreviewStaff" >
	        M_review_Staff = #mreviewStaff:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="state" >
	        state = #state:VARCHAR#
	      </isNotEmpty>
	      <isEmpty property="state">
	      	<isNotEmpty property="stateList" prepend="and">
	      		state in
	      		<iterate open="(" conjunction="," close=")" property="stateList">
	      			#stateList[]#
	      		</iterate>
	      	</isNotEmpty>
	      </isEmpty>
	      <isNotEmpty prepend="and" property="userId" >
	        user_id = #userId:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty property="beginTime">
	    	<isNotEmpty property="endTime" prepend="and">
	    		create_time between #beginTime# and #endTime#
	    	</isNotEmpty>
	      </isNotEmpty>

	      <isNotEmpty prepend="and" property="isInternalAccount" >
	        is_internal_account = #isInternalAccount:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="activityId" >
        	activity_id = #activityId:VARCHAR#
     	   </isNotEmpty>
       </dynamic>
  </select>

  <!-- 查询内部商户 -->
  <select id="getInnerMerchant" resultMap="MerchantResult">
  	select * from merchant where is_internal_account="1"
  </select>

  <select id="getMerchantByType" resultMap="MerchantResult" parameterClass="string">
  	select * from merchant where preferential_type=#value#
  </select>

  <select id="getMerchantNameById" parameterClass="string" resultClass="string">
  	select M_company_full_name from merchant where id=#value# 
  </select>

  <select id="selectBySellerId" resultMap="MerchantResult" parameterClass="java.lang.Integer">
    select * from merchant where id=(select merchant_id from seller where id=#value#)
  </select>

  <!-- 按主键查询商户 -->
  <select id="selectByPrimaryKey" resultMap="MerchantResult" parameterClass="java.lang.Integer">
    select * from merchant where id=#value#
  </select>

  <!-- 按注册时间查询商户 -->
  <select id="selectByRegTime" parameterClass="java.util.HashMap" resultMap="MerchantResult">
  	select * from merchant where create_time between #beginTime# and #endTime#
  </select>

  <!-- 按主键删除商户 -->
  <delete id="deleteByPrimaryKey" parameterClass="java.lang.Integer" >
    delete from merchant where id = #value#
  </delete>

  <!-- 添加商户 -->
  <insert id="insert" parameterClass="merchant" >
    insert into merchant (preference_desc,id, client_img1,client_img2,
    	M_dc_hyperlink, M_company_full_name, M_company_short_name,
      M_company_Logo_url, M_company_Logo_format, M_company_address, M_company_zip, M_company_fax,
      M_company_Tel, M_company_Legal_Name, M_company_Legal_Credent_Type, M_company_Legal_Credent_No,
      M_company_Contact_Name, M_company_Contact_Tel_1, M_company_Contact_Tel_2,
      M_company_Contact_Email, M_store_full_name, M_store_short_name, M_store_Logo_url,
      M_store_Logo_format, M_store_address, M_store_zip, M_store_fax, M_store_Tel,
      M_store_Contact_Name, M_store_Contact_Tel_1, M_store_Contact_Tel_2, M_store_Contact_Email,
      M_contract_begintime, preferential_type,point_rate,preferential_rate,merchant_priority, M_contract_endtime, local_Station_id, local_Bank_id, M_contract_Staff,
      M_review_Staff, state, create_time, update_time, user_id, remark,audit_staff,is_internal_account,
      business_license_url,tax_registration_certificate_url,
      organization_code_certificate_url,legal_idcard_url,hot_level,is_hot,activity_id,is_spring_activity,isaffordpresellflag)
    values (#preferenceDesc#,#id:INT#,#clientImg1#,#clientImg2#,
    	 #dcHyperlink:VARCHAR#, #companyFullName:VARCHAR#, #companyShortName:VARCHAR#,
      #companyLogoUrl:VARCHAR#, #companyLogoFormat:VARCHAR#, #companyAddress:VARCHAR#,
      #companyZip:VARCHAR#, #companyFax:VARCHAR#, #companyTel:VARCHAR#, #companyLegalName:VARCHAR#,
      #companyLegalCredentType:VARCHAR#, #companyLegalCredentNo:VARCHAR#,
      #companyContactName:VARCHAR#, #companyContactTel1:VARCHAR#, #companyContactTel2:VARCHAR#,
      #mcompanyContactEmail:VARCHAR#, #mstoreFullName:VARCHAR#, #mstoreShortName:VARCHAR#,
      #mstoreLogoUrl:VARCHAR#, #mstoreLogoFormat:VARCHAR#, #mstoreAddress:VARCHAR#,
      #mstoreZip:VARCHAR#, #mstoreFax:VARCHAR#, #mstoreTel:VARCHAR#, #mstoreContactName:VARCHAR#,
      #mstoreContactTel1:VARCHAR#, #mstoreContactTel2:VARCHAR#, #mstoreContactEmail:VARCHAR#,
      #mcontractBegintime:VARCHAR#, #preferentialType:VARCHAR#,#pointRate:VARCHAR#, #preferentialRate:VARCHAR#,#merchantPriority:VARCHAR#, #mcontractEndtime:VARCHAR#, #localStationId:VARCHAR#,
      #localBankId:VARCHAR#, #mcontractStaff:VARCHAR#, #mreviewStaff:VARCHAR#, #state:VARCHAR#,
      #createTime:VARCHAR#, #updateTime:VARCHAR#, #userId:VARCHAR#, #remark:VARCHAR#,#auditStaff:VARCHAR#,
      #isInternalAccount:VARCHAR#,#businessLicenseUrl:VARCHAR#,#taxRegistrationCertificateUrl:VARCHAR#,
      #organizationCodeCertificateUrl:VARCHAR#,
      #legalIdcardUrl:VARCHAR#,#hotLevel#,#isHot#,#activityId#,#isSpringActivity#,#isAffordPresellFlag#)
      <selectKey resultClass="int" keyProperty="id">
      	select last_insert_id() as id
      </selectKey>
  </insert>

  <!-- 更新商户信息 -->
  <update id="updateById" parameterClass="merchant" >
        update merchant set update_time = DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s")
    <dynamic>
     <isNotEmpty prepend="," property="preferenceDesc" >
        preference_desc = #preferenceDesc:VARCHAR#
     </isNotEmpty>
     <isNotEmpty prepend="," property="hotLevel" >
        hot_level = #hotLevel:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="isHot" >
        is_hot = #isHot:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="dcHyperlink" >
        M_dc_hyperlink = #dcHyperlink:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="companyFullName" >
        M_company_full_name = #companyFullName:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="companyShortName" >
        M_company_short_name = #companyShortName:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="companyLogoUrl" >
        M_company_Logo_url = #companyLogoUrl:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="companyLogoFormat" >
        M_company_Logo_format = #companyLogoFormat:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="companyAddress" >
        M_company_address = #companyAddress:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="companyZip" >
        M_company_zip = #companyZip:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="companyFax" >
        M_company_fax = #companyFax:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="companyTel" >
        M_company_Tel = #companyTel:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="companyLegalName" >
        M_company_Legal_Name = #companyLegalName:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="companyLegalCredentType" >
        M_company_Legal_Credent_Type = #companyLegalCredentType:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="companyLegalCredentNo" >
        M_company_Legal_Credent_No = #companyLegalCredentNo:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="companyContactName" >
        M_company_Contact_Name = #companyContactName:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="companyContactTel1" >
        M_company_Contact_Tel_1 = #companyContactTel1:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="companyContactTel2" >
        M_company_Contact_Tel_2 = #companyContactTel2:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mcompanyContactEmail" >
        M_company_Contact_Email = #mcompanyContactEmail:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mstoreFullName" >
        M_store_full_name = #mstoreFullName:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mstoreShortName" >
        M_store_short_name = #mstoreShortName:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mstoreLogoUrl" >
        M_store_Logo_url = #mstoreLogoUrl:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mstoreLogoFormat" >
        M_store_Logo_format = #mstoreLogoFormat:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mstoreAddress" >
        M_store_address = #mstoreAddress:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mstoreZip" >
        M_store_zip = #mstoreZip:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mstoreFax" >
        M_store_fax = #mstoreFax:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mstoreTel" >
        M_store_Tel = #mstoreTel:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mstoreContactName" >
        M_store_Contact_Name = #mstoreContactName:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mstoreContactTel1" >
        M_store_Contact_Tel_1 = #mstoreContactTel1:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mstoreContactTel2" >
        M_store_Contact_Tel_2 = #mstoreContactTel2:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mstoreContactEmail" >
        M_store_Contact_Email = #mstoreContactEmail:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mcontractBegintime" >
        M_contract_begintime = #mcontractBegintime:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="pointRate" >
        point_rate= #pointRate:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="preferentialRate" >
      	preferential_rate = #preferentialRate:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="preferentialType" >
        preferential_type = #preferentialType:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="merchantPriority" >
      	merchant_priority = #merchantPriority:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mcontractEndtime" >
        M_contract_endtime = #mcontractEndtime:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="localStationId" >
        local_Station_id = #localStationId:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="localBankId" >
        local_Bank_id = #localBankId:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mcontractStaff" >
        M_contract_Staff = #mcontractStaff:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="mreviewStaff" >
        M_review_Staff = #mreviewStaff:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="state" >
        state = #state:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="userId" >
        user_id = #userId:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="remark" >
        remark = #remark:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="clientImg1" >
        client_img1 = #clientImg1:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="clientImg2" >
        client_img2 = #clientImg2:VARCHAR#
      </isNotEmpty>

      <isNotEmpty prepend="," property="businessLicenseUrl" >
        business_license_url = #businessLicenseUrl:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="taxRegistrationCertificateUrl" >
        tax_registration_certificate_url = #taxRegistrationCertificateUrl:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="organizationCodeCertificateUrl" >
        organization_code_certificate_url = #organizationCodeCertificateUrl:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="legalIdcardUrl" >
        legal_idcard_url = #legalIdcardUrl:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="activityId" >
        	activity_id = #activityId:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="isSpringActivity" >
        	is_spring_activity = #isSpringActivity:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="," property="isAffordPresellFlag" >
            isaffordpresellflag = #isAffordPresellFlag:VARCHAR#
       </isNotEmpty>
    </dynamic>
    where id = #id:INT#
  </update>

  <update id="auditMerchant" parameterClass="merchant">
  	update merchant set audit_staff=#auditStaff#,state=#state# , update_time = DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s") where id=#id#
  </update>

  <update id="reviewMerchant" parameterClass="merchant">
  	update merchant set M_review_Staff=#mreviewStaff#,state=#state#,update_time = DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s") where id=#id#
  </update>

  <!-- 按指定条件查询商户列表 -->
   <select id="selectMerchants"  resultMap="MerchantResult"  parameterClass="merchant">
    select * from merchant
	  <dynamic prepend="where">
	  	<isNotEmpty prepend="and" property="id" >
	       id = #id:INT#
	      </isNotEmpty>
	 	 <isNotEmpty prepend="and" property="dcHyperlink" >
	        M_dc_hyperlink = #dcHyperlink:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyFullName" >
	        M_company_full_name like concat('%',#companyFullName#,'%')
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyShortName" >
	        M_company_short_name = #companyShortName:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLogoUrl" >
	        M_company_Logo_url = #companyLogoUrl:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLogoFormat" >
	        M_company_Logo_format = #companyLogoFormat:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyAddress" >
	        M_company_address = #companyAddress:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyZip" >
	        M_company_zip = #companyZip:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyFax" >
	        M_company_fax = #companyFax:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyTel" >
	        M_company_Tel = #companyTel:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalName" >
	        M_company_Legal_Name = #companyLegalName:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalCredentType" >
	        M_company_Legal_Credent_Type = #companyLegalCredentType:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalCredentNo" >
	        M_company_Legal_Credent_No = #companyLegalCredentNo:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyContactName" >
	        M_company_Contact_Name = #companyContactName:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyContactTel1" >
	        M_company_Contact_Tel_1 = #companyContactTel1:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyContactTel2" >
	        M_company_Contact_Tel_2 = #companyContactTel2:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcompanyContactEmail" >
	        M_company_Contact_Email = #mcompanyContactEmail:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreFullName" >
	        M_store_full_name like concat('%',#mstoreFullName#,'%')
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreShortName" >
	        M_store_short_name = #mstoreShortName:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreLogoUrl" >
	        M_store_Logo_url = #mstoreLogoUrl:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreLogoFormat" >
	        M_store_Logo_format = #mstoreLogoFormat:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreAddress" >
	        M_store_address = #mstoreAddress:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreZip" >
	        M_store_zip = #mstoreZip:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreFax" >
	        M_store_fax = #mstoreFax:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreTel" >
	        M_store_Tel = #mstoreTel:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreContactName" >
	        M_store_Contact_Name = #mstoreContactName:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreContactTel1" >
	        M_store_Contact_Tel_1 = #mstoreContactTel1:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreContactTel2" >
	        M_store_Contact_Tel_2 = #mstoreContactTel2:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreContactEmail" >
	        M_store_Contact_Email = #mstoreContactEmail:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractBegintime" >
	        M_contract_begintime = #mcontractBegintime:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="pointRate" >
	        point_rate= #pointRate:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="preferentialRate" >
	      	preferential_rate = #preferentialRate:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="preferentialType" >
	        preferential_type = #preferentialType:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="merchantPriority" >
	      	merchant_priority = #merchantPriority:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractEndtime" >
	        M_contract_endtime = #mcontractEndtime:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="localStationId" >
	        local_Station_id = #localStationId:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="localBankId" >
	        local_Bank_id = #localBankId:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractStaff" >
	        M_contract_Staff = #mcontractStaff:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mreviewStaff" >
	        M_review_Staff = #mreviewStaff:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="state" >
	        state = #state:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="remark" >
	        remark = #remark:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="userId" >
	        user_id = #userId:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="isInternalAccount">
	      	is_internal_account = #isInternalAccount#
	      </isNotEmpty>
	      <isNotEmpty property="beginTime">
	      	<isNotEmpty prepend="and" property="endTime">
	      		create_time between #beginTime# and #endTime#
	      	</isNotEmpty>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="activityId" >
        	activity_id = #activityId:VARCHAR#
     	   </isNotEmpty>
	  </dynamic>
	  order by $orderBy$ $orderType$
	  <!--
	  ORDER BY id DESC -->
  </select>

  <!-- 按用户编号查询商户编号 -->
  <select id="getMerchantIdByUserId" parameterClass="string" resultClass="int">
  	select id from merchant where user_id=#userId#
  </select>

  <!-- 按用户编号查询商户 -->
  <select id="getMerchantByUserId" parameterClass="string" resultMap="MerchantResult">
  	select * from merchant where user_id=#userId#
  </select>

   <!-- 根据标签ID(分类ID或者商圈ID)查询商户 分页 -->
     <select id="FIND-MERCHANTS-BY-TAGID"  parameterClass="merchant" resultClass="merchant">
    	<![CDATA[ SELECT a.id AS id,
				    a.M_dc_hyperlink AS dcHyperlink, 
				    a.M_company_full_name AS companyFullName, 
				    a.M_company_short_name AS companyShortName, 
				    a.M_company_Logo_url AS companyLogoUrl,
				    a.M_company_Logo_format AS companyLogoFormat, 
				    a.M_company_address AS companyAddress, 
				    a.M_company_zip AS companyZip, 
				    a.M_company_fax AS companyFax, 
				    a.M_company_Tel AS companyTel,
				    a.M_company_Legal_Name AS companyLegalName, 
				    a.M_company_Legal_Credent_Type AS companyLegalCredentType, 
				    a.M_company_Legal_Credent_No AS companyLegalCredentNo,
				    a.M_company_Contact_Name AS companyContactName, 
				    a.M_company_Contact_Tel_1 AS companyContactTel1, 
				    a.M_company_Contact_Tel_2 AS companyContactTel2,
				    a.M_company_Contact_Email AS mcompanyContactEmail, 
				    a.M_store_full_name AS mstoreFullName, 
				    a.M_store_short_name AS mstoreShortName, 
				    a.M_store_Logo_url AS mstoreLogoUrl,
				    a.M_store_Logo_format AS mstoreLogoFormat, 
				    a.M_store_address AS mstoreAddress, 
				    a.M_store_zip AS mstoreZip, 
				    a.M_store_fax AS mstoreFax, 
				    a.M_store_Tel AS mstoreTel,
				    a.M_store_Contact_Name AS mstoreContactName, 
				    a.M_store_Contact_Tel_1 AS mstoreContactTel1, 
				    a.M_store_Contact_Tel_2 AS mstoreContactTel2, 
				    a.M_store_Contact_Email AS mstoreContactEmail,
				    a.M_contract_begintime AS mcontractBegintime, 
				    a.point_rate AS pointRate,
				    a.preferential_rate AS preferentialRate,
				    a.preferential_type AS preferentialType,
				    a.merchant_priority AS merchantPriority,
				    a.M_contract_endtime AS mcontractEndtime, 
				    a.local_Station_id AS localStationId, 
				    a.local_Bank_id AS localBankId, 
				    a.M_contract_Staff AS mcontractStaff,
				    a.M_review_Staff AS mreviewStaff, 
				    a.state AS state, 
				    a.create_time AS createTime, 
				    a.update_time AS updateTime, 
				    a.user_id AS userId, 
				    a.remark AS remark,
				    count(distinct a.id)
	          	FROM merchant a, tag_map b
	          	WHERE 	a.state = '30'
	          			AND a.is_internal_account <> '1'
	          			AND a.preferential_type <> '3'
	        			AND a.id = b.Merchant_id
			 ]]>
				          <dynamic>
				            <isNotEmpty prepend=" AND " property="tagClassifyAId">
				                <![CDATA[  b.tag_classify_a_id = #tagClassifyAId# ]]>
				            </isNotEmpty>
				            <isNotEmpty prepend=" AND " property="tagClassifyBId">
				                <![CDATA[  b.tag_classify_b_id = #tagClassifyBId# ]]>
				            </isNotEmpty>
				            <isNotEmpty prepend=" AND " property="tagDistrictAId">
				                <![CDATA[  b.tag_district_a_id = #tagDistrictAId# ]]>
				            </isNotEmpty>
				            <isNotEmpty prepend=" AND " property="tagDistrictBId">
				                <![CDATA[  b.tag_district_b_id = #tagDistrictBId# ]]>
				            </isNotEmpty>
				            <isNotEmpty prepend="AND" property="preferentialType">
				                <![CDATA[
				                	a.preferential_type = #preferentialType#
				                 ]]>
				            </isNotEmpty>
				           <isNotEmpty prepend="AND" property="isSpringActivity">
				            	a.is_spring_activity = #isSpringActivity#
				            </isNotEmpty>
				          </dynamic>
					        		group by a.id
					        		ORDER BY a.merchant_priority*1 DESC
					      <isNotEqual compareValue="1" property="isSpringActivity">
										limit
									#startRow#,#pageSize#
					      </isNotEqual>

    </select>
    <!-- 根据标签ID(分类ID或者商圈ID)查询商户 分页 COUNT -->
    <select id="FIND-MERCHANTS-BY-TAGID-COUNT" parameterClass="merchant" resultClass="java.lang.Integer">
        <![CDATA[ 
        	SELECT  count(distinct a.id) FROM merchant a, tag_map b
        	WHERE a.state = '30'
        	AND a.is_internal_account <> '1'
        	AND a.preferential_type <> '3'
        	AND a.id = b.Merchant_id
         ]]>
          <dynamic>
            <isNotEmpty prepend=" AND " property="tagClassifyAId">
                <![CDATA[  b.tag_classify_a_id = #tagClassifyAId# ]]>
            </isNotEmpty>
            <isNotEmpty prepend=" AND " property="tagClassifyBId">
                <![CDATA[  b.tag_classify_b_id = #tagClassifyBId# ]]>
            </isNotEmpty>
            <isNotEmpty prepend=" AND " property="tagDistrictAId">
                <![CDATA[  b.tag_district_a_id = #tagDistrictAId# ]]>
            </isNotEmpty>
            <isNotEmpty prepend=" AND " property="tagDistrictBId">
                <![CDATA[  b.tag_district_b_id = #tagDistrictBId# ]]>
            </isNotEmpty>
            <isNotEmpty prepend="AND" property="preferentialType">
                <![CDATA[  
                	a.preferential_type = #preferentialType#
                 ]]>
            </isNotEmpty>
            <isNotEmpty prepend="AND" property="isSpringActivity">
            	a.is_spring_activity = #isSpringActivity#
            </isNotEmpty>
          </dynamic>
    </select>

     <!-- 根据标签ID(分类AID和分类BID和商圈BID)查询商户 分页 -->
     <select id="FIND-MERCHANTS-BY-CLASSAID-CLASSBID-DISTRICTBID"  parameterClass="merchant" resultClass="merchant">
    	<![CDATA[ SELECT a.id AS id,
				    a.M_dc_hyperlink AS dcHyperlink, 
				    a.M_company_full_name AS companyFullName, 
				    a.M_company_short_name AS companyShortName, 
				    a.M_company_Logo_url AS companyLogoUrl,
				    a.M_company_Logo_format AS companyLogoFormat, 
				    a.M_company_address AS companyAddress, 
				    a.M_company_zip AS companyZip, 
				    a.M_company_fax AS companyFax, 
				    a.M_company_Tel AS companyTel,
				    a.M_company_Legal_Name AS companyLegalName, 
				    a.M_company_Legal_Credent_Type AS companyLegalCredentType, 
				    a.M_company_Legal_Credent_No AS companyLegalCredentNo,
				    a.M_company_Contact_Name AS companyContactName, 
				    a.M_company_Contact_Tel_1 AS companyContactTel1, 
				    a.M_company_Contact_Tel_2 AS companyContactTel2,
				    a.M_company_Contact_Email AS mcompanyContactEmail, 
				    a.M_store_full_name AS mstoreFullName, 
				    a.M_store_short_name AS mstoreShortName, 
				    a.M_store_Logo_url AS mstoreLogoUrl,
				    a.M_store_Logo_format AS mstoreLogoFormat, 
				    a.M_store_address AS mstoreAddress, 
				    a.M_store_zip AS mstoreZip, 
				    a.M_store_fax AS mstoreFax, 
				    a.M_store_Tel AS mstoreTel,
				    a.M_store_Contact_Name AS mstoreContactName, 
				    a.M_store_Contact_Tel_1 AS mstoreContactTel1, 
				    a.M_store_Contact_Tel_2 AS mstoreContactTel2, 
				    a.M_store_Contact_Email AS mstoreContactEmail,
				    a.M_contract_begintime AS mcontractBegintime, 
				    a.point_rate AS pointRate,
				    a.preferential_rate AS preferentialRate,
				    a.preferential_type AS preferentialType,
				    a.merchant_priority AS merchantPriority,
				    a.M_contract_endtime AS mcontractEndtime, 
				    a.local_Station_id AS localStationId, 
				    a.local_Bank_id AS localBankId, 
				    a.M_contract_Staff AS mcontractStaff,
				    a.M_review_Staff AS mreviewStaff, 
				    a.state AS state, 
				    a.create_time AS createTime, 
				    a.update_time AS updateTime, 
				    a.user_id AS userId, 
				    a.remark AS remark,
				    count(distinct a.id)
	          	FROM merchant a, tag_map b
	          	WHERE 	a.state = '30'
	          			AND a.is_internal_account <> '1'
	          			AND a.preferential_type <> '3'
	        			AND a.id = b.Merchant_id
	        			AND (b.tag_classify_a_id = #tagClassifyAId# OR b.tag_classify_b_id = #tagClassifyBId# OR b.tag_district_b_id = #tagDistrictBId#)
	       ]]>
		          <dynamic>
		            <isNotEmpty prepend="AND" property="preferentialType">
		                <![CDATA[
		                	a.preferential_type = #preferentialType#
		                 ]]>
		            </isNotEmpty>
		          </dynamic>
        <![CDATA[
        		group by a.id
				ORDER BY a.merchant_priority DESC
					limit 
				#startRow#,#pageSize#
		 ]]>
    </select>
    <!-- 根据标签ID(分类AID和分类BID和商圈BID)查询商户 分页 COUNT -->
    <select id="FIND-MERCHANTS-BY-CLASSAID-CLASSBID-DISTRICTBID-COUNT" parameterClass="merchant" resultClass="java.lang.Integer">
        <![CDATA[ 
        	SELECT  count(distinct a.id) FROM merchant a, tag_map b
        	WHERE a.state = '30'
        	AND a.is_internal_account <> '1'
        	AND a.id = b.Merchant_id
        	AND a.preferential_type <> '3'
        	AND (b.tag_classify_a_id = #tagClassifyAId# OR b.tag_classify_b_id = #tagClassifyBId# OR b.tag_district_b_id = #tagDistrictBId#)
         ]]>
          <dynamic>
            <isNotEmpty prepend="AND" property="preferentialType">
                <![CDATA[  
                	a.preferential_type = #preferentialType#
                 ]]>
            </isNotEmpty>
          </dynamic>
    </select>

    <!-- 根据标签ID(分类AID和分类BID和商圈AID和商圈BID)查询商户 分页 -->
     <select id="FIND-MERCHANTS-BY-CLASSAID-CLASSBID-DISTRICTAID-DISTRICTBID"  parameterClass="merchant" resultClass="merchant">
    	<![CDATA[ SELECT a.id AS id,
				    a.M_dc_hyperlink AS dcHyperlink, 
				    a.M_company_full_name AS companyFullName, 
				    a.M_company_short_name AS companyShortName, 
				    a.M_company_Logo_url AS companyLogoUrl,
				    a.M_company_Logo_format AS companyLogoFormat, 
				    a.M_company_address AS companyAddress, 
				    a.M_company_zip AS companyZip, 
				    a.M_company_fax AS companyFax, 
				    a.M_company_Tel AS companyTel,
				    a.M_company_Legal_Name AS companyLegalName, 
				    a.M_company_Legal_Credent_Type AS companyLegalCredentType, 
				    a.M_company_Legal_Credent_No AS companyLegalCredentNo,
				    a.M_company_Contact_Name AS companyContactName, 
				    a.M_company_Contact_Tel_1 AS companyContactTel1, 
				    a.M_company_Contact_Tel_2 AS companyContactTel2,
				    a.M_company_Contact_Email AS mcompanyContactEmail, 
				    a.M_store_full_name AS mstoreFullName, 
				    a.M_store_short_name AS mstoreShortName, 
				    a.M_store_Logo_url AS mstoreLogoUrl,
				    a.M_store_Logo_format AS mstoreLogoFormat, 
				    a.M_store_address AS mstoreAddress, 
				    a.M_store_zip AS mstoreZip, 
				    a.M_store_fax AS mstoreFax, 
				    a.M_store_Tel AS mstoreTel,
				    a.M_store_Contact_Name AS mstoreContactName, 
				    a.M_store_Contact_Tel_1 AS mstoreContactTel1, 
				    a.M_store_Contact_Tel_2 AS mstoreContactTel2, 
				    a.M_store_Contact_Email AS mstoreContactEmail,
				    a.M_contract_begintime AS mcontractBegintime, 
				    a.point_rate AS pointRate,
				    a.preferential_rate AS preferentialRate,
				    a.preferential_type AS preferentialType,
				    a.merchant_priority AS merchantPriority,
				    a.M_contract_endtime AS mcontractEndtime, 
				    a.local_Station_id AS localStationId, 
				    a.local_Bank_id AS localBankId, 
				    a.M_contract_Staff AS mcontractStaff,
				    a.M_review_Staff AS mreviewStaff, 
				    a.state AS state, 
				    a.create_time AS createTime, 
				    a.update_time AS updateTime, 
				    a.user_id AS userId, 
				    a.remark AS remark,
				    count(distinct a.id)
	          	FROM merchant a, tag_map b
	          	WHERE 	a.state = '30'
	          			AND a.is_internal_account <> '1'
	          			AND a.preferential_type <> '3'
	        			AND a.id = b.Merchant_id
	        			AND (b.tag_classify_a_id = #tagClassifyAId# OR b.tag_classify_b_id = #tagClassifyBId# OR b.tag_district_a_id = #tagDistrictAId# OR b.tag_district_b_id = #tagDistrictBId#)
	       ]]>
		          <dynamic>
		            <isNotEmpty prepend="AND" property="preferentialType">
		                <![CDATA[
		                	a.preferential_type = #preferentialType#
		                 ]]>
		            </isNotEmpty>
		          </dynamic>
        <![CDATA[
        
        		group by a.id
				ORDER BY a.merchant_priority DESC
					limit 
				#startRow#,#pageSize#
		 ]]>
    </select>
    <!-- 根据标签ID(分类AID和分类BID和商圈AID和商圈BID)查询商户 分页 COUNT -->
    <select id="FIND-MERCHANTS-BY-CLASSAID-CLASSBID-DISTRICTAID-DISTRICTBID-COUNT" parameterClass="merchant" resultClass="java.lang.Integer">
        <![CDATA[ 
        	SELECT  count(distinct a.id) FROM merchant a, tag_map b
        	WHERE a.state = '30'
        	AND a.is_internal_account <> '1'
        	AND a.preferential_type <> '3'
        	AND a.id = b.Merchant_id
        	AND (b.tag_classify_a_id = #tagClassifyAId# OR b.tag_classify_b_id = #tagClassifyBId# OR b.tag_district_a_id = #tagDistrictAId# OR b.tag_district_b_id = #tagDistrictBId#)
         ]]>
          <dynamic>
            <isNotEmpty prepend="AND" property="preferentialType">
                <![CDATA[  
                	a.preferential_type = #preferentialType#
                 ]]>
            </isNotEmpty>
          </dynamic>
    </select>

   <!-- 根据商户的各种状态查询商户，返回商户List -->
    <select id="FIND-MERCHANT-INFO-BY-STATE"  parameterClass="merchant" resultClass="merchant">
    	<![CDATA[ SELECT a.id AS id,
				    a.M_dc_hyperlink AS dcHyperlink, 
				    a.M_company_full_name AS companyFullName, 
				    a.M_company_short_name AS companyShortName, 
				    a.M_company_Logo_url AS companyLogoUrl,
				    a.M_company_Logo_format AS companyLogoFormat, 
				    a.M_company_address AS companyAddress, 
				    a.M_company_zip AS companyZip, 
				    a.M_company_fax AS companyFax, 
				    a.M_company_Tel AS companyTel,
				    a.M_company_Legal_Name AS companyLegalName, 
				    a.M_company_Legal_Credent_Type AS companyLegalCredentType, 
				    a.M_company_Legal_Credent_No AS companyLegalCredentNo,
				    a.M_company_Contact_Name AS companyContactName, 
				    a.M_company_Contact_Tel_1 AS companyContactTel1, 
				    a.M_company_Contact_Tel_2 AS companyContactTel2,
				    a.M_company_Contact_Email AS mcompanyContactEmail, 
				    a.M_store_full_name AS mstoreFullName, 
				    a.M_store_short_name AS mstoreShortName, 
				    a.M_store_Logo_url AS mstoreLogoUrl,
				    a.M_store_Logo_format AS mstoreLogoFormat, 
				    a.M_store_address AS mstoreAddress, 
				    a.M_store_zip AS mstoreZip, 
				    a.M_store_fax AS mstoreFax, 
				    a.M_store_Tel AS mstoreTel,
				    a.M_store_Contact_Name AS mstoreContactName, 
				    a.M_store_Contact_Tel_1 AS mstoreContactTel1, 
				    a.M_store_Contact_Tel_2 AS mstoreContactTel2, 
				    a.M_store_Contact_Email AS mstoreContactEmail,
				    a.M_contract_begintime AS mcontractBegintime, 
				    a.point_rate AS pointRate,
				    a.preferential_rate AS preferentialRate,
				    a.preferential_type AS preferentialType,
				    a.merchant_priority AS merchantPriority,
				    a.M_contract_endtime AS mcontractEndtime, 
				    a.local_Station_id AS localStationId, 
				    a.local_Bank_id AS localBankId, 
				    a.M_contract_Staff AS mcontractStaff,
				    a.M_review_Staff AS mreviewStaff, 
				    a.state AS state, 
				    a.create_time AS createTime, 
				    a.update_time AS updateTime, 
				    a.user_id AS userId, 
				    a.remark AS remark
                FROM merchant a  
                WHERE a.is_internal_account <> '1'
                ]]>
          <dynamic>
            <isNotEmpty prepend=" AND " property="state">
                <![CDATA[  b.state = #state# ]]>
            </isNotEmpty>
          </dynamic>
        <![CDATA[
          order by a.id DESC;
		]]>
    </select>

    <!-- 更新商户状态 -->
    <update id="UPDATE-MERCHANT-STATE-BY-ID"  parameterClass="merchant">
    	<![CDATA[
                UPDATE merchant SET state=#state# ,update_time =DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s")
                WHERE id=#id#    
		]]>
    </update>


     <!-- 分页多条件查询商户  -->  <!-- 排序中首页右下角使用该sql 及ajax 热门商家使用该sql  -->
    <select id="getMerchantByPager"  parameterClass="merchant" resultMap="MerchantResult">
	  select * from merchant
	  <dynamic prepend="where">
	  	  <isNotEmpty prepend="and" property="id" >
        	<![CDATA[ id = #id# ]]>
      	  </isNotEmpty>
      	  <isNotEmpty prepend="and" property="hotLevel" >
        	<![CDATA[ hot_level = #hotLevel:VARCHAR# ]]>
     	   </isNotEmpty>
	      <isNotEmpty prepend="and" property="isHot" >
	        <![CDATA[ is_hot = #isHot:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyFullName" >
	       <![CDATA[  M_company_full_name like concat('%',#companyFullName#,'%') ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyShortName" >
	       <![CDATA[  M_company_short_name like concat('%',#companyShortName#,'%') ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyAddress" >
	       <![CDATA[  M_company_address like concat('%',#companyAddress#,'%') ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyZip" >
	       <![CDATA[ M_company_zip = #companyZip:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalName" >
	       <![CDATA[ M_company_Legal_Name = #companyLegalName:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalCredentType" >
	       <![CDATA[ M_company_Legal_Credent_Type = #companyLegalCredentType:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalCredentNo" >
	       <![CDATA[ M_company_Legal_Credent_No = #companyLegalCredentNo:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyContactName" >
	       <![CDATA[ M_company_Contact_Name = #companyContactName:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreFullName" >
	       <![CDATA[  M_store_full_name like concat('%',#mstoreFullName#,'%')]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreShortName" >
	      <![CDATA[   M_store_short_name like concat('%',#mstoreShortName#,'%')]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreAddress" >
	       <![CDATA[  M_store_address like concat('%',#mstoreAddress#,'%')]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreZip" >
	       <![CDATA[ M_store_zip = #mstoreZip:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreContactName" >
	       <![CDATA[ M_store_Contact_Name = #mstoreContactName:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractBegintime" >
	       <![CDATA[ M_contract_begintime = #mcontractBegintime:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="pointRate" >
	       <![CDATA[ point_rate= #pointRate:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="preferentialRate" >
	      <![CDATA[	preferential_rate = #preferentialRate:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="preferentialType" >
	       <![CDATA[ preferential_type = #preferentialType:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="merchantPriority" >
	      <![CDATA[	merchant_priority = #merchantPriority:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractEndtime" >
	      <![CDATA[  M_contract_endtime = #mcontractEndtime:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractStaff" >
	      <![CDATA[  M_contract_Staff = #mcontractStaff:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mreviewStaff" >
	       <![CDATA[ M_review_Staff = #mreviewStaff:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="state" >
	       <![CDATA[ state = #state:VARCHAR# ]]>
	      </isNotEmpty>
	      <isEmpty property="state">
	      	<isNotEmpty property="stateList" prepend="and">
	      		state in
	      		<iterate open="(" conjunction="," close=")" property="stateList">
	      			#stateList[]#
	      		</iterate>
	      	</isNotEmpty>
	      </isEmpty>
	      <isNotEmpty prepend="and" property="userId" >
	       <![CDATA[ user_id = #userId:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty property="beginTime">
	    	<isNotEmpty property="endTime" prepend="and">
	    	<![CDATA[	create_time between #beginTime# and #endTime# ]]>
	    	</isNotEmpty>
	      </isNotEmpty>

	      <isNotEmpty prepend="and" property="isInternalAccount" >
	      <![CDATA[  is_internal_account = #isInternalAccount:VARCHAR# ]]>
	      </isNotEmpty>
       </dynamic>
	   <![CDATA[
	    order by $orderBy$ $orderType$
	     limit
	    #startRow#,#pageSize#
	    ]]>
    </select>

    <select id="getMerchantByPagerCount"  parameterClass="merchant" resultClass="java.lang.Integer">
	   select count(*) from merchant
	  <dynamic prepend="where">
	  	  <isNotEmpty prepend="and" property="id" >
        	id = #id#
      	  </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyFullName" >
	        M_company_full_name like concat('%',#companyFullName#,'%')
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="hotLevel" >
        	hot_level = #hotLevel:VARCHAR#
     	   </isNotEmpty>
	      <isNotEmpty prepend="and" property="isHot" >
	        is_hot = #isHot:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyShortName" >
	        M_company_short_name like concat('%',#companyShortName#,'%')
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyAddress" >
	        M_company_address like concat('%',#companyAddress#,'%')
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyZip" >
	        M_company_zip = #companyZip:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalName" >
	        M_company_Legal_Name = #companyLegalName:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalCredentType" >
	        M_company_Legal_Credent_Type = #companyLegalCredentType:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalCredentNo" >
	        M_company_Legal_Credent_No = #companyLegalCredentNo:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyContactName" >
	        M_company_Contact_Name = #companyContactName:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreFullName" >
	        M_store_full_name like concat('%',#mstoreFullName#,'%')
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreShortName" >
	        M_store_short_name like concat('%',#mstoreShortName#,'%')
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreAddress" >
	        M_store_address like concat('%',#mstoreAddress#,'%')
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreZip" >
	        M_store_zip = #mstoreZip:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreContactName" >
	        M_store_Contact_Name = #mstoreContactName:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractBegintime" >
	        M_contract_begintime = #mcontractBegintime:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="pointRate" >
	        point_rate= #pointRate:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="preferentialRate" >
	      	preferential_rate = #preferentialRate:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="preferentialType" >
	        preferential_type = #preferentialType:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="merchantPriority" >
	      	merchant_priority = #merchantPriority:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractEndtime" >
	        M_contract_endtime = #mcontractEndtime:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractStaff" >
	        M_contract_Staff = #mcontractStaff:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mreviewStaff" >
	        M_review_Staff = #mreviewStaff:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="state" >
	        state = #state:VARCHAR#
	      </isNotEmpty>
	       <isEmpty property="state">
	      	<isNotEmpty property="stateList" prepend="and">
	      		state in
	      		<iterate open="(" conjunction="," close=")" property="stateList">
	      			#stateList[]#
	      		</iterate>
	      	</isNotEmpty>
	      </isEmpty>
	      <isNotEmpty prepend="and" property="userId" >
	        user_id = #userId:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty property="beginTime">
	    	<isNotEmpty property="endTime" prepend="and">
	    		create_time between #beginTime# and #endTime#
	    	</isNotEmpty>
	      </isNotEmpty>

	       <isNotEmpty prepend="and" property="isInternalAccount" >
	        is_internal_account = #isInternalAccount:VARCHAR#
	      </isNotEmpty>

       </dynamic>
    </select>

     <select id="getMerchantsPreferentialType"  parameterClass="merchant" resultMap="MerchantResult">
	  select * from merchant where <![CDATA[preferential_type <> '3']]>
	  <dynamic>
	  	  <isNotEmpty prepend="and" property="id" >
        	<![CDATA[ id = #id# ]]>
      	  </isNotEmpty>
      	  <isNotEmpty prepend="and" property="hotLevel" >
        	<![CDATA[ hot_level = #hotLevel:VARCHAR# ]]>
     	   </isNotEmpty>
	      <isNotEmpty prepend="and" property="isHot" >
	        <![CDATA[ is_hot = #isHot:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyFullName" >
	       <![CDATA[  M_company_full_name like concat('%',#companyFullName#,'%') ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyShortName" >
	       <![CDATA[  M_company_short_name like concat('%',#companyShortName#,'%') ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyAddress" >
	       <![CDATA[  M_company_address like concat('%',#companyAddress#,'%') ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyZip" >
	       <![CDATA[ M_company_zip = #companyZip:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalName" >
	       <![CDATA[ M_company_Legal_Name = #companyLegalName:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalCredentType" >
	       <![CDATA[ M_company_Legal_Credent_Type = #companyLegalCredentType:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalCredentNo" >
	       <![CDATA[ M_company_Legal_Credent_No = #companyLegalCredentNo:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyContactName" >
	       <![CDATA[ M_company_Contact_Name = #companyContactName:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreFullName" >
	       <![CDATA[  M_store_full_name like concat('%',#mstoreFullName#,'%')]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreShortName" >
	      <![CDATA[   M_store_short_name like concat('%',#mstoreShortName#,'%')]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreAddress" >
	       <![CDATA[  M_store_address like concat('%',#mstoreAddress#,'%')]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreZip" >
	       <![CDATA[ M_store_zip = #mstoreZip:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreContactName" >
	       <![CDATA[ M_store_Contact_Name = #mstoreContactName:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractBegintime" >
	       <![CDATA[ M_contract_begintime = #mcontractBegintime:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="pointRate" >
	       <![CDATA[ point_rate= #pointRate:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="preferentialRate" >
	      <![CDATA[	preferential_rate = #preferentialRate:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="merchantPriority" >
	      <![CDATA[	merchant_priority = #merchantPriority:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractEndtime" >
	      <![CDATA[  M_contract_endtime = #mcontractEndtime:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractStaff" >
	      <![CDATA[  M_contract_Staff = #mcontractStaff:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mreviewStaff" >
	       <![CDATA[ M_review_Staff = #mreviewStaff:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="state" >
	       <![CDATA[ state = #state:VARCHAR# ]]>
	      </isNotEmpty>
	      <isEmpty property="state">
	      	<isNotEmpty property="stateList" prepend="and">
	      		state in
	      		<iterate open="(" conjunction="," close=")" property="stateList">
	      			#stateList[]#
	      		</iterate>
	      	</isNotEmpty>
	      </isEmpty>
	      <isNotEmpty prepend="and" property="userId" >
	       <![CDATA[ user_id = #userId:VARCHAR# ]]>
	      </isNotEmpty>
	      <isNotEmpty property="beginTime">
	    	<isNotEmpty property="endTime" prepend="and">
	    	<![CDATA[	create_time between #beginTime# and #endTime# ]]>
	    	</isNotEmpty>
	      </isNotEmpty>

	      <isNotEmpty prepend="and" property="isInternalAccount" >
	      <![CDATA[  is_internal_account = #isInternalAccount:VARCHAR# ]]>
	      </isNotEmpty>
       </dynamic>
	   <![CDATA[
	    order by $orderBy$ $orderType$
	     limit
	    #startRow#,#pageSize#
	    ]]>
    </select>


    <select id="getMerchantsPreferentialTypeCount"  parameterClass="merchant" resultClass="java.lang.Integer">
	   select count(*) from merchant where <![CDATA[preferential_type <> '3']]>
	  <dynamic>
	  	  <isNotEmpty prepend="and" property="id" >
        	id = #id#
      	  </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyFullName" >
	        M_company_full_name like concat('%',#companyFullName#,'%')
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="hotLevel" >
        	hot_level = #hotLevel:VARCHAR#
     	   </isNotEmpty>
	      <isNotEmpty prepend="and" property="isHot" >
	        is_hot = #isHot:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyShortName" >
	        M_company_short_name like concat('%',#companyShortName#,'%')
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyAddress" >
	        M_company_address like concat('%',#companyAddress#,'%')
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyZip" >
	        M_company_zip = #companyZip:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalName" >
	        M_company_Legal_Name = #companyLegalName:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalCredentType" >
	        M_company_Legal_Credent_Type = #companyLegalCredentType:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyLegalCredentNo" >
	        M_company_Legal_Credent_No = #companyLegalCredentNo:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="companyContactName" >
	        M_company_Contact_Name = #companyContactName:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreFullName" >
	        M_store_full_name like concat('%',#mstoreFullName#,'%')
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreShortName" >
	        M_store_short_name like concat('%',#mstoreShortName#,'%')
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreAddress" >
	        M_store_address like concat('%',#mstoreAddress#,'%')
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreZip" >
	        M_store_zip = #mstoreZip:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mstoreContactName" >
	        M_store_Contact_Name = #mstoreContactName:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractBegintime" >
	        M_contract_begintime = #mcontractBegintime:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="pointRate" >
	        point_rate= #pointRate:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="preferentialRate" >
	      	preferential_rate = #preferentialRate:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="merchantPriority" >
	      	merchant_priority = #merchantPriority:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractEndtime" >
	        M_contract_endtime = #mcontractEndtime:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mcontractStaff" >
	        M_contract_Staff = #mcontractStaff:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="mreviewStaff" >
	        M_review_Staff = #mreviewStaff:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty prepend="and" property="state" >
	        state = #state:VARCHAR#
	      </isNotEmpty>
	       <isEmpty property="state">
	      	<isNotEmpty property="stateList" prepend="and">
	      		state in
	      		<iterate open="(" conjunction="," close=")" property="stateList">
	      			#stateList[]#
	      		</iterate>
	      	</isNotEmpty>
	      </isEmpty>
	      <isNotEmpty prepend="and" property="userId" >
	        user_id = #userId:VARCHAR#
	      </isNotEmpty>
	      <isNotEmpty property="beginTime">
	    	<isNotEmpty property="endTime" prepend="and">
	    		create_time between #beginTime# and #endTime#
	    	</isNotEmpty>
	      </isNotEmpty>

	       <isNotEmpty prepend="and" property="isInternalAccount" >
	        is_internal_account = #isInternalAccount:VARCHAR#
	      </isNotEmpty>

       </dynamic>
    </select>

</sqlMap>