<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="goodsPresellRackImages">
	<typeAlias alias="goodsPresellRackImages" type="com.froad.CB.po.GoodsPresellRackImages" />	
	<resultMap class="goodsPresellRackImages" id="goodsPresellRackImagesResult">
		<result property="id" column="id" jdbcType="INTEGER"/>
		<result property="goodsPresellRackId" column="goods_presell_rack_id" jdbcType="VARCHAR"/>
		<result property="imagesUrl" column="images_url" jdbcType="VARCHAR"/>
		<result property="state" column="state" jdbcType="VARCHAR"/>
		<result property="createTime" column="create_time" jdbcType="VARCHAR"/>
		<result property="updateTime" column="update_time" jdbcType="VARCHAR"/>	
		<result property="remark" column="remark" jdbcType="VARCHAR"/>		
	</resultMap>
		
	<insert id="insert" parameterClass="goodsPresellRackImages">
		insert into goods_presell_rack_images (
			goods_presell_rack_id,images_url,state,
			create_time,update_time,remark
			
			) values(
			#goodsPresellRackId#,#imagesUrl#,20,
			DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s"),
			DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s"),#remark#
		)		
		<selectKey keyProperty="id" resultClass="int">
			select last_insert_id() as id
		</selectKey>
	</insert>
	
	<update id="updateById" parameterClass="goodsPresellRackImages" >
		update goods_presell_rack_images set update_time=DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s")
		<dynamic prepend="">
			<isNotEmpty property="goodsPresellRackId" prepend=",">
				goods_presell_rack_id=#goodsPresellRackId#
			</isNotEmpty>
			<isNotEmpty property="imagesUrl" prepend=",">
				images_url=#imagesUrl#
			</isNotEmpty>	
			<isNotEmpty property="state" prepend=",">
				state=#state#
			</isNotEmpty>	
			<isNotEmpty property="remark" prepend=",">
				remark=#remark#
			</isNotEmpty>			
		</dynamic>		
			where id=#id#	
	</update>
	
		<update id="updateObject" parameterClass="goodsPresellRackImages">		
			update goods_presell_rack_images set update_time = DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s")
			<dynamic>
				<isNotEmpty prepend="," property="goodsPresellRackId">
					goods_presell_rack_id = #goodsPresellRackId:VARCHAR#
				</isNotEmpty>
				<isNotEmpty prepend="," property="imagesUrl">
					images_url = #imagesUrl:VARCHAR#
				</isNotEmpty>
				<isNotEmpty prepend="," property="state">
					state = #state:VARCHAR#
				</isNotEmpty>
				<isNotEmpty prepend="," property="remark">
					remark = #remark:VARCHAR#
				</isNotEmpty>
			</dynamic>		
      	<dynamic  prepend="where">
			<isNotEmpty prepend="and" property="id">
				<![CDATA[ id = #id:INTEGER# ]]>
			</isNotEmpty>
			<isNotEmpty prepend="and" property="goodsPresellRackId">
				<![CDATA[ goods_presell_rack_id = #goodsPresellRackId:VARCHAR# ]]>
			</isNotEmpty>
		</dynamic>
	</update>
	
	
	
	
	<select id="getById" parameterClass="java.lang.Integer" resultMap="goodsPresellRackImagesResult">
		select * from goods_presell_rack_images where id=#id#	
	</select>
	
	<select id="getByConditions" parameterClass="goodsPresellRackImages" resultMap="goodsPresellRackImagesResult">
		select * from goods_presell_rack_images 
		<dynamic prepend="where">
			<isNotEmpty property="id" prepend="and">
				id=#id#
			</isNotEmpty>			
			<isNotEmpty property="goodsPresellRackId" prepend="and">
				goods_presell_rack_id=#goodsPresellRackId#
			</isNotEmpty>
			<isNotEmpty property="imagesUrl" prepend="and">
				images_url=#imagesUrl#
			</isNotEmpty>	
			<isNotEmpty property="state" prepend="and">
				state=#state#
			</isNotEmpty>		
		</dynamic>	
	</select>
	
	<select id="getByGoodsRackId" parameterClass="java.lang.Integer" resultMap="goodsPresellRackImagesResult">
		select * from goods_presell_rack_images where goods_presell_rack_id=#rackId# and state=30
	</select>		

</sqlMap>