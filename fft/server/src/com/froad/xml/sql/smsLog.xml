<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="smsLog">
	
	<typeAlias alias="smsLog" type="com.froad.CB.po.SmsLog"/>
	
	<resultMap class="smsLog" id="SmsLogResult">
		<result column="id" jdbcType="INTEGER" property="id" />
		<result column="type" jdbcType="VARCHAR" property="type" />
		<result column="mobile" jdbcType="VARCHAR" property="mobile" />
		<result column="message" jdbcType="VARCHAR" property="message" />
		<result column="result" jdbcType="VARCHAR" property="result" />
		<result column="state" jdbcType="VARCHAR" property="state" />
		<result column="create_time" jdbcType="VARCHAR" property="createTime" />
		<result column="update_time" jdbcType="VARCHAR" property="updateTime" />
		<result column="remark" jdbcType="VARCHAR" property="remark" />
	</resultMap>
	
	<select id="selectByPrimaryKey" parameterClass="java.lang.Integer" resultMap="SmsLogResult">
		select * from sms_log where id = #id:INTEGER#
	</select>
	
	<delete id="deleteByPrimaryKey" parameterClass="java.lang.Integer">
		delete from sms_log where id = #id:INTEGER#
	</delete>
	
	<insert id="insert" parameterClass="smsLog">
		insert into sms_log (id, type, mobile, message, result, state,
		remark,create_time, update_time) values (#id:INTEGER#,
		#type:VARCHAR#, #mobile:VARCHAR#, #message:VARCHAR#,
		#result:VARCHAR#, #state:VARCHAR#,#remark:VARCHAR#,
		DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s"),DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s"))
		<selectKey keyProperty="id" resultClass="int">
		 select last_insert_id() as id
		</selectKey>
	</insert>
	
	<update id="updateById" parameterClass="smsLog">
		update sms_log set update_time=DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s")
		<dynamic>
			<isNotEmpty prepend="," property="type">
				type = #type:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="," property="mobile">
				mobile = #mobile:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="," property="message">
				message = #message:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="," property="result">
				result = #result:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="," property="state">
				state = #state:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="," property="updateTime">
				update_time = #updateTime:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="," property="remark">
				remark = #remark:VARCHAR#
			</isNotEmpty>
		</dynamic>
		where id = #id:INTEGER#
	</update>
	
	<!-- 更新短信的发送结果 -->
	<update id="updateResultById" parameterClass="smsLog">
		update sms_log set update_time=DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s"),
		result = #result:VARCHAR# where id = #id:INTEGER#
	</update>
</sqlMap>