<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="merchantPhotos" >
	
	<typeAlias alias="merchantPhoto" type="com.froad.CB.po.merchant.MerchantPhoto"/>
	
	<resultMap id="MerchantPhotoResult" class="merchantPhoto" >
	  <result column="id" property="id" jdbcType="INT" />
	  <result column="Merchant_id" property="MerchantId" jdbcType="VARCHAR" />
	  <result column="photo_url" property="photoUrl" jdbcType="VARCHAR" />
	  <result column="photo_format_1" property="photoFormat1" jdbcType="VARCHAR" />
	  <result column="photo_format_2" property="photoFormat2" jdbcType="VARCHAR" />
	  <result column="array" property="array" jdbcType="VARCHAR" />
	  <result column="txt_1" property="txt1" jdbcType="VARCHAR" />
	  <result column="txt_2" property="txt2" jdbcType="VARCHAR" />
	  <result column="txt_3" property="txt3" jdbcType="VARCHAR" />
	  <result column="state" property="state" jdbcType="VARCHAR" />
	  <result column="create_time" property="createTime" jdbcType="VARCHAR" />
	  <result column="update_time" property="updateTime" jdbcType="VARCHAR" />
	  <result column="remark" property="remark" jdbcType="VARCHAR" />
	</resultMap>
	  
	  <!-- 按主键查询商户图片 -->
	<select id="selectByPrimaryKey" resultMap="MerchantPhotoResult" parameterClass="java.lang.Integer" >
	      select * from merchant_photos where id = #id:INT#
	</select>
	
	<!-- 按主键删除商户图片 -->
	<delete id="deleteByPrimaryKey" parameterClass="merchantPhoto" >
	      delete from merchant_photos where id = #id:INT#
	</delete>
	
	<!-- 按主键逻辑删除商户图片 -->
	<update id="deleteStateByPrimaryKey" parameterClass="merchantPhoto" >
	     update merchant_photos a 
	     set a.state = '50',
	     	a.update_time = DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s")
	     where id = #id:INT#
	</update>
	
	<!-- 添加商户图片 -->
	<insert id="insert" parameterClass="merchantPhoto" >
	      insert into merchant_photos (id, Merchant_id, photo_url, photo_format_1, photo_format_2,
	    array, txt_1, txt_2, txt_3, state, create_time, update_time, remark)
	  values (#id:INT#, #MerchantId:VARCHAR#, #photoUrl:VARCHAR#, #photoFormat1:VARCHAR#,
	    #photoFormat2:VARCHAR#, #array:VARCHAR#, #txt1:VARCHAR#, #txt2:VARCHAR#, #txt3:VARCHAR#,
	    #state:VARCHAR#, DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s"), DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s"), #remark:VARCHAR#)
	    <selectKey resultClass="int" keyProperty="id">
	       select last_insert_id() as id
	    </selectKey>
	</insert>
	
	<!-- 按主键更新商户图片 -->
	<update id="updateById" parameterClass="merchantPhoto" >
	      update merchant_photos set update_time = DATE_FORMAT(NOW(),"%Y-%m-%d|%H:%i:%s")
	  <dynamic prepend="" >
	    <isNotEmpty prepend="," property="MerchantId" >
	      Merchant_id = #MerchantId:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="," property="photoUrl" >
	      photo_url = #photoUrl:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="," property="photoFormat1" >
	      photo_format_1 = #photoFormat1:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="," property="photoFormat2" >
	      photo_format_2 = #photoFormat2:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="," property="array" >
	      array = #array:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="," property="txt1" >
	      txt_1 = #txt1:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="," property="txt2" >
	      txt_2 = #txt2:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="," property="txt3" >
	      txt_3 = #txt3:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="," property="state" >
	      state = #state:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="," property="remark" >
	      remark = #remark:VARCHAR#
	    </isNotEmpty>
	  </dynamic>
	  where id = #id:INT#
	</update>
	
	<!-- 按指定条件查询商户图片列表 -->
	<select id="selectMerchantPhotos" resultMap="MerchantPhotoResult" parameterClass="merchantPhoto" >
	select * from merchant_photos
	  <dynamic prepend="where" >
	  <isNotEmpty prepend="and" property="id" >
	      id = #id:INT#
	    </isNotEmpty>
	    <isNotEmpty prepend="and" property="MerchantId" >
	      Merchant_id = #MerchantId:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="and" property="photoUrl" >
	      photo_url = #photoUrl:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="and" property="photoFormat1" >
	      photo_format_1 = #photoFormat1:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="and" property="photoFormat2" >
	      photo_format_2 = #photoFormat2:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="and" property="array" >
	      array = #array:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="and" property="txt1" >
	      txt_1 = #txt1:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="and" property="txt2" >
	      txt_2 = #txt2:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="and" property="txt3" >
	      txt_3 = #txt3:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="and" property="state" >
	      state = #state:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="and" property="createTime" >
	      create_time = #createTime:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="and" property="updateTime" >
	      update_time = #updateTime:VARCHAR#
	    </isNotEmpty>
	    <isNotEmpty prepend="and" property="remark" >
	      remark = #remark:VARCHAR#
	    </isNotEmpty>
	  </dynamic>
	</select>
	
	 <!-- 商户ID 查找商品   -->
	<select id="getMerchantPhotosByByMerchantId" resultMap="MerchantPhotoResult" parameterClass="string" >
		select * from merchant_photos where state='30' and Merchant_id=#merchantId#
	</select>
	<!-- 商户ID 查找商品  -->
	
	<!-- 多条件分页查询商户相册 -->
    <select id="getByPager"  resultMap="MerchantPhotoResult" parameterClass="merchantPhoto">
    	select * from merchant_photos
	    <dynamic prepend="where">
		    <isNotEmpty prepend="and" property="id" >
	          id = #id#
	      	</isNotEmpty>
		    <isNotEmpty prepend="and" property="MerchantId" >
		      Merchant_id = #MerchantId:VARCHAR#
		    </isNotEmpty>
		    <isNotEmpty prepend="and" property="state" >
		      state = #state:VARCHAR#
		    </isNotEmpty>
			<isNotEmpty property="beginTime">
		    	<isNotEmpty property="endTime" prepend="and">
		    		create_time between #beginTime# and #endTime#
		    	</isNotEmpty>
		     </isNotEmpty>
		   </dynamic>
	       order by $orderBy$ $orderType$ limit #startRow#,#pageSize#
    </select>
    
    <select id="getByPagerCount" parameterClass="merchantPhoto" resultClass="java.lang.Integer">
        select count(*) from merchant_photos
	    <dynamic prepend="where">
		    <isNotEmpty prepend="and" property="id" >
	          id = #id#
	      	</isNotEmpty>
		    <isNotEmpty prepend="and" property="MerchantId" >
		      Merchant_id = #MerchantId:VARCHAR#
		    </isNotEmpty>
		    <isNotEmpty prepend="and" property="state" >
		      state = #state:VARCHAR#
		    </isNotEmpty>
			<isNotEmpty property="beginTime">
		    	<isNotEmpty property="endTime" prepend="and">
		    		create_time between #beginTime# and #endTime#
		    	</isNotEmpty>
		     </isNotEmpty>
		  </dynamic>
    </select>
</sqlMap>