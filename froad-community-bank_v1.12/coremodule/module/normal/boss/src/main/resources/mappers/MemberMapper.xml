<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.froad.cbank.coremodule.normal.boss.mapper.MemberMapper">

	<resultMap type="member" id="memberReportResultMap">
		<id property="id" column="id" />
		<result column="client_id" property="clientId" /> 
		<result column="type" property="type" />  
		<result column="user_resource_count" property="userResourceCount" /> 
		<result column="user_count" property="userCount" /> 
		<result column="create_time" property="createTime" /> 	
	</resultMap>
	<select id="getListByPage" resultMap="memberReportResultMap">
		SELECT 
			COUNT(distinct m.CLIENT_ID) user_resource_count,
			SUM(m.user_count) user_count,
			m.create_time create_time
	 	FROM bi_member m WHERE CLIENT_ID != 'anhui' and CLIENT_ID != 'lanbo' 
 	<if test="base.clientId!=null and base.clientId!=''">
			AND CLIENT_ID=#{base.clientId}
		</if>
		<if test="base.startTime!=null and base.startTime!=null">
			<![CDATA[
				AND CREATE_TIME>=#{base.startTime}
			]]>
		</if>
		<if test="base.endTime!=null and base.endTime !=''">
			<![CDATA[
				AND CREATE_TIME<=#{base.endTime}
			]]>
		</if>	
 		 GROUP BY m.create_time 
 		 ORDER BY m.create_time DESC
	</select>
</mapper>