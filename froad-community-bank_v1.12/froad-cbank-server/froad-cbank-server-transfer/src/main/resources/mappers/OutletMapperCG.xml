<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.froad.db.chonggou.mappers.OutletMapperCG">

	<resultMap type="OutletCG" id="outletResultMap">
		<id property="id" column="id" />
		<result property="createTime" column="create_time" />
		<result property="clientId" column="client_id" />
		<result property="merchantId" column="merchant_id" />
		<result property="outletId" column="outlet_id" />
		<result property="areaId" column="area_id" />
		<result property="orderValue" column="order_value" />
		<result property="outletName" column="outlet_name" />
		<result property="outletFullname" column="outlet_fullname" />
		<result property="outletStatus" column="outlet_status" />
		<result property="address" column="address" />
		<result property="businessHours" column="business_hours" />
		<result property="zip" column="zip" />
		<result property="fax" column="fax" />
		<result property="phone" column="phone" />
		<result property="contactName" column="contact_name" />
		<result property="contactPhone" column="contact_phone" />
		<result property="contactEmail" column="contact_email" />
		<result property="serviceProvider" column="service_provider" />
		<result property="longitude" column="longitude" />
		<result property="latitude" column="latitude" />
		<result property="isEnable" column="is_enable" />
		<result property="description" column="description" />
		<result property="preferDetails" column="prefer_details" />
		<result property="preferStartPeriod" column="prefer_start_period" />
		<result property="preferEndPeriod" column="prefer_end_period" />
		<result property="discount" column="discount" />
		<result property="disableStatus" column="disable_status" />
<!-- 		<result property="storeCount" column="store_count" /> -->
	</resultMap>
	
	
		<!-- 查询  Outlet -->
	<select id="findOutletByOutletId" parameterType="java.lang.String" resultMap="outletResultMap">
		SELECT 
            id,create_time,client_id,merchant_id,outlet_id,area_id,order_value,outlet_name,outlet_fullname,outlet_status,address,business_hours,zip,fax,phone,contact_name,contact_phone,contact_email,service_provider,longitude,latitude,is_enable,description,prefer_details,prefer_start_period,prefer_end_period,discount 
        FROM cb_outlet 
        WHERE 
            outlet_id = #{outletId}

	</select>


	<!-- 添加  Outlet -->
	<insert id="addOutlet" parameterType="OutletCG" useGeneratedKeys="true" keyProperty="id">
		<![CDATA[
			INSERT INTO cb_outlet (
				create_time,client_id,merchant_id,outlet_id,area_id,order_value,outlet_name,outlet_fullname,outlet_status,address,business_hours,zip,fax,phone,contact_name,contact_phone,contact_email,service_provider,longitude,latitude,is_enable,description,prefer_details,prefer_start_period,prefer_end_period,discount,disable_status
			) VALUES (
				#{createTime},#{clientId},#{merchantId},#{outletId},#{areaId},#{orderValue},#{outletName},#{outletFullname},#{outletStatus},#{address},#{businessHours},#{zip},#{fax},#{phone},#{contactName},#{contactPhone},#{contactEmail},#{serviceProvider},#{longitude},#{latitude},#{isEnable},#{description},#{preferDetails},#{preferStartPeriod},#{preferEndPeriod},#{discount},#{disableStatus}
			) 
		]]>
	</insert>


	<!-- 批量添加  Outlet -->
	<insert id="addOutletByBatch" parameterType="java.util.List">
		INSERT INTO cb_outlet (
			create_time,client_id,merchant_id,outlet_id,area_id,order_value,outlet_name,outlet_fullname,outlet_status,address,business_hours,zip,fax,phone,contact_name,contact_phone,contact_email,service_provider,longitude,latitude,is_enable,description,prefer_details,prefer_start_period,prefer_end_period,discount
		) VALUES 
		<foreach collection="outletList" item="item" index="index" separator=",">
			(#{createTime},#{clientId},#{merchantId},#{outletId},#{areaId},#{orderValue},#{outletName},#{outletFullname},#{outletStatus},#{address},#{businessHours},#{zip},#{fax},#{phone},#{contactName},#{contactPhone},#{contactEmail},#{serviceProvider},#{longitude},#{latitude},#{isEnable},#{description},#{preferDetails},#{preferStartPeriod},#{preferEndPeriod},#{discount}
		</foreach>
	</insert>


	<select id="findOneOutletCG" parameterType="OutletCG" resultMap="outletResultMap">
		select * from cb_outlet	
		<where>
			<if test="id != null">
				 AND id = #{id}
			</if>
			<if test="clientId != null">
				 AND client_id = #{clientId}
			</if>
			<if test="merchantId != null">
				 AND merchant_id = #{merchantId}
			</if>
			<if test="outletId != null">
				 AND outlet_id = #{outletId}
			</if>
			<if test="outletName != null">
				AND outlet_name = #{outletName}
			</if>
		</where>
	</select>
	
	
	<select id="findGroupList"  resultMap="outletResultMap">
		SELECT
			t.outlet_id
		FROM
			cb_outlet t GROUP BY t.merchant_id
	</select>
	
	<update id="updateOutlet" parameterType="OutletCG" >
		update cb_outlet set merchant_id=#{merchantId} where outlet_id=#{outletId}
	
	</update>
</mapper>

