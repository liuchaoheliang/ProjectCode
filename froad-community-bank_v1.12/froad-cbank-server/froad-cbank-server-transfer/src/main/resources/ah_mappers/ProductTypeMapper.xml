<?xml version="1.0" encoding="UTF-8" ?>  
	<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
  		 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.froad.fft.persistent.api.ProductTypeMapper">

	<resultMap type="ProductType" id="productTypeResultMap">
		<id property="id" column="id" />
		<result property="createTime" column="create_time" />
		<result property="updateTime" column="update_time" />

		<result property="name" column="name" />
		<result property="dataState" column="data_state" typeHandler="com.froad.db.extend.EnumTypeHandler" />
	</resultMap>
	
	<!-- 插入 -->
	<insert id="saveProductType" parameterType="ProductType" useGeneratedKeys="true" keyProperty="id" >
		insert into fft_product_type values
		(
			#{id},#{createTime},#{updateTime},#{name},30
		)
	</insert>

	<!-- 更新 -->
	<update id="updateProductTypeById" parameterType="ProductType">
		update fft_product_type set update_time = #{updateTime}
		<if test="name != null">
			,name = #{name}
		</if>
		<if test="dataState != null">
			,data_state = #{dataState,typeHandler=com.froad.db.extend.EnumTypeHandler}
		</if>
		where id = #{id}
	</update>
	
	<!-- 查询 -->
	<select id="selectProductTypeById" parameterType="java.lang.Long" resultMap="productTypeResultMap">
		select * from fft_product_type where id = #{id}
	</select>
	
	<!-- 分页查询 -->
	<select id="findProductTypeByPage" parameterType="com.froad.fft.persistent.bean.page.Page" resultMap="productTypeResultMap"> 
		<![CDATA[ 
			select * from fft_product_type
		]]>
		
		<!-- 条件 -->
		<if test="pageFilter != null">
			<where>
				<if test="pageFilter.filterEntity != null">
					<if test="pageFilter.filterEntity.name!= null">
						and name like CONCAT('%',#{pageFilter.filterEntity.name},'%' ) 
					</if>
					<if test="pageFilter.filterEntity.dataState!= null">
						and data_state = #{pageFilter.filterEntity.dataState,typeHandler=com.froad.db.extend.EnumTypeHandler}
					</if>
				</if>
				<!-- 时间段条件 -->
				<if test="pageFilter.property != null and pageFilter.startTime != null">
					<![CDATA[
					 and ${pageFilter.property} >= #{pageFilter.startTime}
					]]>
				</if>
				<if test="pageFilter.property != null and pageFilter.endTime != null">
					<![CDATA[
					 and ${pageFilter.property} <= #{pageFilter.endTime}
					]]>
				</if>
			</where>
		</if>
		
		<!-- 排序 --> 
		<if test="order != null">
			<if test="order.property != null and order.direction != null">
				order by ${order.property} ${order.direction} 
			</if>
		</if>
		
	</select>
	
	<!-- 分页总数 -->
	<select id="findProductTypeByPageCount" parameterType="com.froad.fft.persistent.bean.page.Page" resultType="java.lang.Integer"> 
		<![CDATA[ 
			select count(0) from fft_product_type
		]]>
		
		<!-- 条件 -->
		<if test="pageFilter != null">
			<where>
				<if test="pageFilter.filterEntity != null">
					<if test="pageFilter.filterEntity.name!= null">
						and name like CONCAT('%',#{pageFilter.filterEntity.name},'%' ) 
					</if>
					<if test="pageFilter.filterEntity.dataState!= null">
						and data_state = #{pageFilter.filterEntity.dataState,typeHandler=com.froad.db.extend.EnumTypeHandler}
					</if>
				</if>
				<!-- 时间段条件 -->
				<if test="pageFilter.property != null and pageFilter.startTime != null">
					<![CDATA[
					 and ${pageFilter.property} >= #{pageFilter.startTime}
					]]>
				</if>
				<if test="pageFilter.property != null and pageFilter.endTime != null">
					<![CDATA[
					 and ${pageFilter.property} <= #{pageFilter.endTime}
					]]>
				</if>
			</where>
		</if>
		
	</select>
</mapper>