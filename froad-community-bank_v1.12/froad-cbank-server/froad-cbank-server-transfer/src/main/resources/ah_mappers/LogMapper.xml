<?xml version="1.0" encoding="UTF-8" ?>  
	<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
  		 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.froad.fft.persistent.api.LogMapper">
	<resultMap type="Log" id="logResultMap">
		<id property="id" column="id" />
		<result property="createTime" column="create_time" />
		<result property="updateTime" column="update_time" />
		<result property="operation" column="operation" />
		<result property="operator" column="operator" />
		<result property="content" column="content" />
		<result property="parameter" column="parameter" />
		<result property="ip" column="ip" />
	</resultMap>
	
	<!-- 插入 -->
	<insert id="saveLog" parameterType="Log" useGeneratedKeys="true" keyProperty="id" >
		insert into fft_log values
		(
			#{id},#{createTime},#{updateTime},#{operation},#{operator},#{content},#{parameter},#{ip}
		)
	</insert>

	<!-- 更新 -->
	<update id="updateLogById" parameterType="Log">
		update fft_log set update_time = #{updateTime}
		<if test="operation != null">
			,operation = #{operation}
		</if>
		<if test="operator != null">
			,operator = #{operator}
		</if>
		<if test="content != null">
			,content = #{content}
		</if>
		<if test="ip != null">
			,ip = #{ip}
		</if>
		<if test="parameter != null">
			,parameter = #{parameter}
		</if>
		where id = #{id}
	</update>
	
	<!-- 查询 -->
	<select id="selectLogById" parameterType="java.lang.Long" resultMap="logResultMap">
		select * from fft_log where id = #{id}
	</select>
	
	
	
	<!-- 分页查询 -->
	<select id="findLogByPage" parameterType="com.froad.fft.persistent.bean.page.Page" resultMap="logResultMap"> 
		<![CDATA[ 
			select * from fft_log
		]]>
		
		<!-- 条件 -->
		<if test="pageFilter != null">
			<where>
				<if test="pageFilter.filterEntity != null">
					<if test="pageFilter.filterEntity.operator!= null">
						and operator like CONCAT('%',#{pageFilter.filterEntity.operator},'%' ) 
					</if>
					<if test="pageFilter.filterEntity.content!= null">
						and content like CONCAT('%',#{pageFilter.filterEntity.content},'%' ) 
					</if>
				</if>
				<!-- 时间段条件 -->
				<if test="pageFilter.property != null and pageFilter.startTime != null">
					<![CDATA[
					 and ${pageFilter.property} >= #{pageFilter.startTime}
					]]>
				</if>
				<if test="pageFilter.property != null and pageFilter.endTime != null">
					<![CDATA[
					 and ${pageFilter.property} <= #{pageFilter.endTime}
					]]>
				</if>
			</where>
		</if>
		
		<!-- 排序 --> 
		<if test="order != null">
			<if test="order.property != null and order.direction != null">
				order by ${order.property} ${order.direction} 
			</if>
		</if>
		
	</select>
	
	<!-- 分页总数 -->
	<select id="findLogByPageCount" parameterType="com.froad.fft.persistent.bean.page.Page" resultType="java.lang.Integer"> 
		<![CDATA[ 
			select count(0) from fft_log
		]]>
		
		<!-- 条件 -->
		<if test="pageFilter != null">
			<where>
				<if test="pageFilter.filterEntity != null">
					<if test="pageFilter.filterEntity.operator!= null">
						and operator like CONCAT('%',#{pageFilter.filterEntity.operator},'%' ) 
					</if>
					<if test="pageFilter.filterEntity.content!= null">
						and content like CONCAT('%',#{pageFilter.filterEntity.content},'%' ) 
					</if>
				</if>
				<!-- 时间段条件 -->
				<if test="pageFilter.property != null and pageFilter.startTime != null">
					<![CDATA[
					 and ${pageFilter.property} >= #{pageFilter.startTime}
					]]>
				</if>
				<if test="pageFilter.property != null and pageFilter.endTime != null">
					<![CDATA[
					 and ${pageFilter.property} <= #{pageFilter.endTime}
					]]>
				</if>
			</where>
		</if>
		
	</select>
</mapper>