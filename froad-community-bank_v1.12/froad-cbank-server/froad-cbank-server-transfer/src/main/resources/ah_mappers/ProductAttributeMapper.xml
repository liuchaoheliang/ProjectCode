<?xml version="1.0" encoding="UTF-8" ?>  
	<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
  		 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.froad.fft.persistent.api.ProductAttributeMapper">

	<resultMap type="ProductAttribute" id="productAttributeResultMap">
		<id property="id" column="id" />
		<result property="createTime" column="create_time" />
		<result property="updateTime" column="update_time" />

		<result property="name" column="title" />
		<result property="attributeType" column="attribute_type" typeHandler="org.apache.ibatis.type.EnumOrdinalTypeHandler" />
		<result property="isRequired" column="is_required" />
		<result property="isEnabled" column="is_enabled" />
		<result property="orderValue" column="order_value" />
		<result property="productTypeId" column="product_type_id" />
	</resultMap>
	
	<!-- 插入 -->
	<insert id="saveProductAttribute" parameterType="ProductAttribute" useGeneratedKeys="true" keyProperty="id" >
		insert into fft_product_attribute values
		(
			#{id},#{createTime},#{updateTime},#{name},#{attributeType,typeHandler=org.apache.ibatis.type.EnumOrdinalTypeHandler},
			#{isRequired},#{isEnabled},#{orderValue},#{productTypeId}
		)
	</insert>

	<!-- 更新 -->
	<update id="updateProductAttributeById" parameterType="ProductAttribute" >
		update fft_product_attribute set update_time = #{updateTime}
		<if test="name != null">
			,name = #{name}
		</if>
		<if test="attributeType != null">
			,attribute_type = #{attributeType,typeHandler=org.apache.ibatis.type.EnumOrdinalTypeHandler}
		</if>
		<if test="isRequired != null">
			,is_required = #{isRequired}
		</if>
		<if test="isEnabled != null">
			,is_enabled = #{isEnabled}
		</if>
		<if test="orderValue != null">
			,order_value = #{orderValue}
		</if>
		<if test="productTypeId != null">
			,product_type_id = #{productTypeId}
		</if>
		where id = #{id}
	</update>
	
	<!-- 查询 -->
	<select id="selectProductAttributeById" parameterType="java.lang.Long" resultMap="productAttributeResultMap">
		select * from fft_product_attribute where id = #{id}
	</select>
	
	<!-- 分页查询 -->
	<select id="findProductAttributeByPage" parameterType="com.froad.fft.persistent.bean.page.Page" resultMap="productAttributeResultMap"> 
		<![CDATA[ 
			select * from fft_product_attribute
		]]>
		<!-- 条件 -->
		<if test="pageFilter != null">
			<where>
				<if test="pageFilter.filterEntity != null">
					<if test="pageFilter.filterEntity.name!= null">
						and name like CONCAT('%',#{pageFilter.filterEntity.name},'%' ) 
					</if>
					<if test="pageFilter.filterEntity.attributeType!= null">
						and attribute_type = #{pageFilter.filterEntity.attributeType}
					</if>
					<if test="pageFilter.filterEntity.isRequired!= null">
						and is_required = #{pageFilter.filterEntity.isRequired}
					</if>
					<if test="pageFilter.filterEntity.isEnabled!= null">
						and is_enabled = #{pageFilter.filterEntity.isEnabled}
					</if>
					<if test="pageFilter.filterEntity.orderValue!= null">
						and order_value = #{pageFilter.filterEntity.orderValue}
					</if>
					<if test="pageFilter.filterEntity.productTypeId!= null">
						and product_type_id = #{pageFilter.filterEntity.productTypeId}
					</if>
				</if>
				<!-- 时间段条件 -->
				<if test="pageFilter.property != null and pageFilter.startTime != null">
					<![CDATA[
					 and ${pageFilter.property} >= #{pageFilter.startTime}
					]]>
				</if>
				<if test="pageFilter.property != null and pageFilter.endTime != null">
					<![CDATA[
					 and ${pageFilter.property} <= #{pageFilter.endTime}
					]]>
				</if>
			</where>
		</if>
		
		<!-- 排序 --> 
		<if test="order != null">
			<if test="order.property != null and order.direction != null">
				order by ${order.property} ${order.direction} 
			</if>
		</if>
		
	</select>
	
	<!-- 分页总数 -->
	<select id="findProductAttributeByPageCount" parameterType="com.froad.fft.persistent.bean.page.Page" resultType="java.lang.Integer"> 
		<![CDATA[ 
			select count(0) from fft_product_attribute
		]]>
		
		<!-- 条件 -->
		<if test="pageFilter != null">
			<where>
				<if test="pageFilter.filterEntity != null">
					<if test="pageFilter.filterEntity.name!= null">
						and name like CONCAT('%',#{pageFilter.filterEntity.name},'%' ) 
					</if>
					<if test="pageFilter.filterEntity.attributeType!= null">
						and attribute_type = #{pageFilter.filterEntity.attributeType}
					</if>
					<if test="pageFilter.filterEntity.isRequired!= null">
						and is_required = #{pageFilter.filterEntity.isRequired}
					</if>
					<if test="pageFilter.filterEntity.isEnabled!= null">
						and is_enabled = #{pageFilter.filterEntity.isEnabled}
					</if>
					<if test="pageFilter.filterEntity.orderValue!= null">
						and order_value = #{pageFilter.filterEntity.orderValue}
					</if>
					<if test="pageFilter.filterEntity.productTypeId!= null">
						and product_type_id = #{pageFilter.filterEntity.productTypeId}
					</if>
				</if>
				<!-- 时间段条件 -->
				<if test="pageFilter.property != null and pageFilter.startTime != null">
					<![CDATA[
					 and ${pageFilter.property} >= #{pageFilter.startTime}
					]]>
				</if>
				<if test="pageFilter.property != null and pageFilter.endTime != null">
					<![CDATA[
					 and ${pageFilter.property} <= #{pageFilter.endTime}
					]]>
				</if>
			</where>
		</if>
		
	</select>
	
</mapper>