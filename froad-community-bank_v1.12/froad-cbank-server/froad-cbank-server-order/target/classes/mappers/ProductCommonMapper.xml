<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.froad.db.mysql.mapper.ProductCommonMapper">

	<resultMap type="Product" id="productCommonResultMap">
		<id property="id" column="id" />
		<result property="clientId" column="client_id" />
		<result property="merchantId" column="merchant_id" />
		<result property="merchantName" column="merchant_name" />
		<result property="orgCode" column="org_code" />
		<result property="productId" column="product_id" />
		<result property="isMarketable" column="is_marketable" />
		<result property="createTime" column="create_time" />
		<result property="rackTime" column="rack_time" />
		<result property="downTime" column="down_time" />
		<result property="deliveryTime" column="delivery_time" />
		<result property="startTime" column="start_time" />
		<result property="endTime" column="end_time" />
		<result property="type" column="type" />
		<result property="deliveryOption" column="delivery_option" />
		<result property="name" column="name" />
		<result property="fullName" column="full_name" />
		<result property="price" column="price" />
		<result property="cost" column="cost" />
		<result property="marketPrice" column="market_price" />
		<result property="weight" column="weight" />
		<result property="weightUnit" column="weight_unit" />
		<result property="store" column="store" />
		<result property="isBest" column="is_best" />
		<result property="isLimit" column="is_limit" />
		<result property="point" column="point" />
		<result property="briefIntroduction" column="brief_introduction" />
		<result property="introduction" column="introduction" />
		<result property="buyKnow" column="buy_know" />
		<result property="auditState" column="audit_state" />
		<result property="auditOrgCode" column="audit_org_code" />
		<result property="auditStartOrgCode" column="audit_start_org_code" />
		<result property="auditEndOrgCode" column="audit_end_org_code" /> 
		<result property="auditStage" column="audit_stage" />
		<result property="auditTime" column="audit_time" />
		<result property="auditComment" column="audit_comment" />
		<result property="reviewStaff" column="review_staff" />
		<result property="auditStaff" column="audit_staff" />
		<result property="orderValue" column="order_value" />
		<result property="sellCount" column="sell_count" />
		<result property="deliveryMoney" column="delivery_money" />
		<result property="isSeckill" column="is_seckill" />
		<result property="proOrgCode" column="province_agency" />
		<result property="cityOrgCode" column="city_agency" />
		<result property="countryOrgCode" column="county_agency" />
		<result property="categoryTreePath" column="category_tree_path" />
		<result property="vipPrice" column="vip_price" />
	</resultMap>
	
	<resultMap type="ProductGroup" id="productCommonGroupResultMap">
		<id property="id" column="id" />
		<result property="createTime" column="create_time" />
		<result property="clientId" column="client_id" />
		<result property="productId" column="product_id" />
		<result property="trueBuyerNumber" column="true_buyer_number" />
		<result property="virtualBuyerNumber" column="virtual_buyer_number" />
		<result property="expireStartTime" column="expire_start_time" />
		<result property="expireEndTime" column="expire_end_time" />
	</resultMap>
	
	<resultMap type="ProductPresell" id="productCommonPresellResultMap">
		<id property="id" column="id" />
		<result property="createTime" column="create_time" />
		<result property="clientId" column="client_id" />
		<result property="productId" column="product_id" />
		<result property="productSupplier" column="product_supplier" />
		<result property="maxPerOutlet" column="max_per_outlet" />
		<result property="deliveryStartTime" column="delivery_start_time" />
		<result property="deliveryEndTime" column="delivery_end_time" />
		<result property="trueBuyerNumber" column="true_buyer_number" />
		<result property="virtualBuyerNumber" column="virtual_buyer_number" />
		<result property="clusterState" column="cluster_state" />
		<result property="clusterType" column="cluster_type" />
		<result property="expireStartTime" column="expire_start_time" />
		<result property="expireEndTime" column="expire_end_time" />
	</resultMap>
	
	<resultMap type="ProductSeckill" id="productCommonSeckillResultMap">
		<id property="id" column="id" />
		<result property="clientId" column="client_id" />
		<result property="merchantId" column="merchant_id" />
		<result property="createTime" column="create_time" />
		<result property="productId" column="product_id" />
		<result property="type" column="type" />
		<result property="secStore" column="sec_store" />
		<result property="secPrice" column="sec_price" />
		<result property="vipSecPrice" column="vip_sec_price" />
		<result property="startTime" column="start_time" />
		<result property="endTime" column="end_time" />
		<result property="trueBuyerNumber" column="true_buyer_number" />
		<result property="buyLimit" column="buy_limit" />
		<result property="isMarketable" column="is_marketable" />
		<result property="auditStartOrgCode" column="audit_start_org_code" />
		<result property="auditEndOrgCode" column="audit_End_org_code" />
		<result property="auditState" column="audit_state" />
		<result property="auditOrgCode" column="audit_org_code" />
		<result property="auditStage" column="audit_stage" />
		<result property="reviewStaff" column="review_staff" />
		<result property="auditStaff" column="audit_staff" />
		<result property="auditTime" column="audit_time" />
		<result property="auditComment" column="audit_comment" />
		<result property="type" column="type" />
		<result property="name" column="name" />
		<result property="price" column="price" />
		<result property="marketPrice" column="market_price" />
		<result property="deliveryStartTime" column="delivery_start_time" />
		<result property="deliveryEndTime" column="delivery_end_time" />
		<result property="briefIntroduction" column="brief_introduction" />
		<result property="phone" column="phone" />
		<result property="deliveryOption" column="delivery_option" />
		<result property="buyKnow" column="buy_know" />
		<result property="orgCode" column="org_code" />
		<result property="orgName" column="org_name" />
		<result property="merchantName" column="merchant_name" />
		<result property="fullName" column="full_name" />
		<result property="status" column="status" />
		<result property="isPoint" column="is_point" />
	</resultMap>
	
	<resultMap type="VipProduct" id="vipProductResultMap">
		<id property="id" column="id" />
		<result property="vipId" column="vip_id" />
		<result property="createTime" column="create_time" />
		<result property="clientId" column="client_id" />
		<result property="clientName" column="client_name" />
		<result property="activitiesName" column="activities_name" />
		<result property="vipPrice" column="vip_price" />
		<result property="status" column="status" />
		<result property="count" column="count" />
		<result property="remark" column="remark" />
	</resultMap>
	
	
	<!-- 查询  Product -->
	<select id="getProductByPid" parameterType="Map" resultMap="productCommonResultMap">
		SELECT id,create_time,client_id,merchant_id,product_id,is_marketable,type,price,market_price,name,delivery_time,start_time,end_time,delivery_money,is_point,point,category_tree_path,
		rack_time,audit_state,down_time,vip_price 
		FROM cb_product WHERE product_id = #{productId}
		<if test="clientId != null and clientId !=''">
		     AND client_id = #{clientId}
		</if>
	</select>
	
	<!-- 查询  ProductGroup -->
	<select id="getProductGroupByPid" parameterType="Map" resultMap="productCommonGroupResultMap">
		SELECT id,client_id,product_id,true_buyer_number,virtual_buyer_number,expire_start_time,expire_end_time 
		FROM cb_product_group WHERE product_id = #{productId}
		<if test="clientId != null and clientId !=''">
		     AND client_id = #{clientId}
		</if>
	</select>
	
	<!-- 查询  ProductPresell -->
	<select id="getProductPresellByPid" parameterType="Map" resultMap="productCommonPresellResultMap">
		SELECT id,client_id,product_id,delivery_start_time,delivery_end_time,true_buyer_number,virtual_buyer_number,expire_start_time,expire_end_time,cluster_state 
		FROM cb_product_presell WHERE product_id = #{productId}
		<if test="clientId != null and clientId !=''">
		     AND client_id = #{clientId}
		</if>
	</select>
	
	
	<!-- 查询  Product的库存 -->
	<select id="getProductStoreByPid" parameterType="Map" resultMap="productCommonResultMap">
		SELECT id,client_id,merchant_id,product_id,store 
		FROM cb_product WHERE product_id = #{productId}
		<if test="clientId != null and clientId !=''">
		     AND client_id = #{clientId}
		</if>
	</select>
	
	<!-- 查询  Product Seckill 的库存 -->
	<select id="getSeckillProductStoreByPid" parameterType="Map" resultMap="productCommonSeckillResultMap">
		SELECT id,client_id,merchant_id,product_id,sec_store 
		FROM cb_product_seckill WHERE product_id = #{productId}
		<if test="clientId != null and clientId !=''">
		     AND client_id = #{clientId}
		</if>
	</select>
	
	<!-- 查询  ProductPresell的最大门店提货数 -->
	<select id="getProductMaxPerOutletByPid" parameterType="Map" resultMap="productCommonPresellResultMap">
		SELECT id,client_id,product_id,max_per_outlet
		FROM cb_product_presell WHERE product_id = #{productId}
		<if test="clientId != null and clientId !=''">
		     AND client_id = #{clientId}
		</if>
	</select>
	
	<!-- 根据商户id修改商品表的商户名称 -->
	<update id="updateMerchantNameByMerchantId" >
		UPDATE cb_product SET merchant_name = #{merchantName} WHERE merchant_id = #{merchantId} 
	</update>
	
	<!-- 根据客户端id查询单独一条已经有效的vip规则 -->
	<select id="getVipProductByClientId" parameterType="String" resultMap="vipProductResultMap">
		<![CDATA[
		SELECT id,vip_id,create_time,client_id,client_name,activities_name,vip_price,status,count,remark   
		FROM cb_vip_product WHERE client_id = #{clientId} AND status = '1' LIMIT 1
		]]> 
	</select>
	
	<!-- 查询  Product -->
	<select id="findProductByProductId" parameterType="java.lang.String" resultMap="productCommonResultMap">
		SELECT 
           id,client_id,merchant_id,product_id,is_marketable,org_code,create_time,rack_time,down_time,start_time,end_time,type,delivery_option,name,full_name,merchant_name FROM cb_product 
        WHERE 
            product_id = #{productId}

	</select>
	
	<select id="findProductByClientId" parameterType="java.lang.String" resultMap="productCommonResultMap">
		SELECT 
           id,client_id,merchant_id,product_id,is_marketable,org_code,create_time,rack_time,down_time,start_time,end_time,type,delivery_option,name,full_name,merchant_name FROM cb_product 
        WHERE 
            client_id = #{clientId}

	</select>
	
</mapper>

