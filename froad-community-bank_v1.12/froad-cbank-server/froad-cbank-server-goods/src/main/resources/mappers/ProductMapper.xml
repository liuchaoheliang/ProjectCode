<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.froad.db.mysql.mapper.ProductMapper">

	<resultMap type="Product" id="productResultMap">
		<id property="id" column="id" />
		<result property="clientId" column="client_id" />
		<result property="merchantId" column="merchant_id" />
		<result property="orgCode" column="org_code" />
		<result property="productId" column="product_id" />
		<result property="isMarketable" column="is_marketable" />
		<result property="createTime" column="create_time" />
		<result property="rackTime" column="rack_time" />
		<result property="downTime" column="down_time" />
		<result property="startTime" column="start_time" />
		<result property="endTime" column="end_time" />
		<result property="type" column="type" />
		<result property="deliveryOption" column="delivery_option" />
		<result property="name" column="name" />
		<result property="fullName" column="full_name" />
		<result property="price" column="price" />
		<result property="cost" column="cost" />
		<result property="marketPrice" column="market_price" />
		<result property="weight" column="weight" />
		<result property="weightUnit" column="weight_unit" />
		<result property="store" column="store" />
		<result property="isBest" column="is_best" />
		<result property="isLimit" column="is_limit" />
		<result property="point" column="point" />
		<result property="briefIntroduction" column="brief_introduction" />
		<result property="introduction" column="introduction" />
		<result property="buyKnow" column="buy_know" />
		<result property="auditState" column="audit_state" />
		<result property="editAuditState" column="edit_audit_state" />
		<result property="auditOrgCode" column="audit_org_code" />
		<result property="auditStartOrgCode" column="audit_start_org_code" />
		<result property="auditEndOrgCode" column="audit_end_org_code" /> 
		<result property="auditStage" column="audit_stage" />
		<result property="auditTime" column="audit_time" />
		<result property="auditComment" column="audit_comment" />
		<result property="reviewStaff" column="review_staff" />
		<result property="auditStaff" column="audit_staff" />
		<result property="orderValue" column="order_value" />
		<result property="sellCount" column="sell_count" />
		<result property="deliveryMoney" column="delivery_money" />
		<result property="isSeckill" column="is_seckill" />
		<result property="proOrgCode" column="province_agency" />
		<result property="cityOrgCode" column="city_agency" />
		<result property="countryOrgCode" column="county_agency" />
		<result property="categoryTreePath" column="category_tree_path" />
		<result property="merchantName" column="merchant_name" />
		<result property="platType" column="plat_type" />
		<result property="isPoint" column="is_point" />
		<result property="codeUrl" column="code_url" />
		<result property="vipPrice" column="vip_price" />
		<result property="deliveryTime" column="delivery_time" />
		<result property="seoKeyWords" column="seo_keyWords" />
		<result property="afterShop" column="after_shop" />
		<result property="goodFlag" column="good_flag" />
	</resultMap>
	
	<resultMap type="ProductGroup" id="productGroupResultMap">
		<id property="id" column="id" />
		<result property="createTime" column="create_time" />
		<result property="clientId" column="client_id" />
		<result property="productId" column="product_id" />
		<result property="trueBuyerNumber" column="true_buyer_number" />
		<result property="virtualBuyerNumber" column="virtual_buyer_number" />
		<result property="expireStartTime" column="expire_start_time" />
		<result property="expireEndTime" column="expire_end_time" />
	</resultMap>
	
	<resultMap type="ProductPresell" id="productPresellResultMap">
		<id property="id" column="id" />
		<result property="createTime" column="create_time" />
		<result property="clientId" column="client_id" />
		<result property="productId" column="product_id" />
		<result property="productSupplier" column="product_supplier" />
		<result property="maxPerOutlet" column="max_per_outlet" />
		<result property="deliveryStartTime" column="delivery_start_time" />
		<result property="deliveryEndTime" column="delivery_end_time" />
		<result property="trueBuyerNumber" column="true_buyer_number" />
		<result property="virtualBuyerNumber" column="virtual_buyer_number" />
		<result property="clusterState" column="cluster_state" />
		<result property="clusterType" column="cluster_type" />
		<result property="expireStartTime" column="expire_start_time" />
		<result property="expireEndTime" column="expire_end_time" />
	</resultMap>
	
	<resultMap type="ProductListInfo" id="productListResultMap">
		<id property="id" column="id" />
		<result property="clientId" column="client_id" />
		<result property="productId" column="product_id" />
		<result property="merchantId" column="merchant_id" />
		<result property="merchantName" column="merchant_name" />
		<result property="type" column="type" />
		<result property="orgCode" column="org_code" />
		<result property="name" column="name" />
		<result property="fullName" column="full_name" />
		<result property="startTime" column="start_time" />
		<result property="endTime" column="end_time" />
		<result property="auditState" column="audit_state" />
		<result property="isMarketable" column="is_marketable" />
		<result property="price" column="price" />
		<result property="store" column="store" />
		<result property="marketPrice" column="market_price" />
		<result property="deliveryOption" column="delivery_option" />
		<result property="createTime" column="create_time" />
		<result property="categoryTreePath" column="category_tree_path" />
		<result property="isSeckill" column="is_seckill" />
		<result property="rackTime" column="rack_time" />
		<result property="auditComment" column="audit_comment" />
		<result property="auditTime" column="audit_time" />
		<result property="auditStaff" column="audit_staff" />
	</resultMap>
	
	<resultMap type="ProductViewInfo" id="productViewResultMap">
		<id property="id" column="id" />
		<result property="clientId" column="client_id" />
		<result property="merchantId" column="merchant_id" />
		<result property="merchantName" column="merchant_name" />
		<result property="orgCode" column="org_code" />
		<result property="productId" column="product_id" />
		<result property="isMarketable" column="is_marketable" />
		<result property="rackTime" column="rack_time" />
		<result property="downTime" column="down_time" />
		<result property="createTime" column="create_time" />
		<result property="type" column="type" />
		<result property="deliveryOption" column="delivery_option" />
		<result property="name" column="name" />
		<result property="fullName" column="full_name" />
		<result property="price" column="price" />
		<result property="cost" column="cost" />
		<result property="marketPrice" column="market_price" />
		<result property="weight" column="weight" />
		<result property="weightUnit" column="weight_unit" />
		<result property="store" column="store" />
		<result property="isBest" column="is_best" />
		<result property="isLimit" column="is_limit" />
		<result property="point" column="point" />
		<result property="briefIntroduction" column="brief_introduction" />
		<result property="introduction" column="introduction" />
		<result property="buyKnow" column="buy_know" />
		<result property="auditState" column="audit_state" />
		<result property="auditTime" column="audit_time" />
		<result property="auditComment" column="audit_comment" />
		<result property="auditOrgCode" column="audit_org_code" />
		<result property="auditStartOrgCode" column="audit_start_org_code" />
		<result property="auditEndOrgCode" column="audit_end_org_code" /> 
		<result property="auditStage" column="audit_stage" />
		<result property="reviewStaff" column="review_staff" />
		<result property="auditStaff" column="audit_staff" />
		<result property="orderValue" column="order_value" />
		<result property="sellCount" column="sell_count" />
		<result property="startTime" column="start_time" />
		<result property="endTime" column="end_time" />
		<result property="deliveryMoney" column="delivery_money" />
		<result property="isSeckill" column="is_seckill" />
		<result property="trueBuyerNumber" column="true_buyer_number" />
		<result property="virtualBuyerNumber" column="virtual_buyer_number" />
		<result property="expireStartTime" column="expire_start_time" />
		<result property="expireEndTime" column="expire_end_time" />
		<result property="productSupplier" column="product_supplier" />
		<result property="maxPerOutlet" column="max_per_outlet" />
		<result property="deliveryStartTime" column="delivery_start_time" />
		<result property="deliveryEndTime" column="delivery_end_time" />
		<result property="clusterState" column="cluster_state" />
		<result property="clusterType" column="cluster_type" />
		<result property="codeUrl" column="code_url" />
		<result property="afterShop" column="after_shop" />
	</resultMap>
	
	<resultMap type="Merchant" id="merchantResultMap">
		<id property="id" column="id" />
		<result property="clientId" column="client_id" />
		<result property="merchantId" column="merchant_id" />
		<result property="orgCode" column="org_code" />
		<result property="merchantName" column="merchant_name" />
		<result property="phone" column="phone" />
		<result property="isEnable" column="is_enable" />
		<result property="merchantStatus" column="merchant_status" />
		<result property="logo" column="logo" />
	</resultMap>
	
	<resultMap type="SenseWord" id="senseWordResultMap">
		<id property="id" column="id" />
		<result property="word" column="word" />
		<result property="isEnable" column="is_enable" />
	</resultMap>
    
    <resultMap type="BankOrgCode" id="bankOrgResultMap">
        <id property="id" column="id" />
        <result property="clientId" column="client_id" />
		<result property="provinceAgency" column="province_agency" />
		<result property="cityAgency" column="city_agency" />
		<result property="countyAgency" column="county_agency" />
        <result property="orgLevel" column="org_level" />
        <result property="orgCode" column="org_code" />
        <result property="orgName" column="org_name" />
        <result property="merchantId" column="merchant_id" />
        <result property="outletId" column="outlet_id" />
        <result property="areaId" column="area_id" />
    </resultMap>
    
    <resultMap type="ProductOutletInfo" id="outletResultMap">
		<id property="id" column="id" />
		<result property="clientId" column="client_id" />
		<result property="outletId" column="outlet_id" />
		<result property="outletName" column="outlet_name" />
		<result property="address" column="address" />
		<result property="phone" column="phone" />
		<result property="areaId" column="area_id" />
		<result property="areaName" column="name" />
		<result property="areaTreePath" column="tree_path" />
		<result property="orgCode" column="org_code" />
	</resultMap>
	
	<resultMap type="ActivitiesInfo" id="activitiesResultMap">
		<id property="id" column="id" />
		<result property="clientId" column="client_id" />
		<result property="activitiesName" column="activities_name" />
		<result property="points" column="points" />
		<result property="status" column="status" />
	</resultMap>
	
	<resultMap type="Area" id="areaResultMap">
		<id property="id" column="id" />
		<result property="name" column="name" />
		<result property="vagueLetter" column="vague_letter" />
		<result property="treePath" column="tree_path" />
		<result property="parentId" column="parent_id" />
		<result property="treePathName" column="tree_path_name" />
		<result property="isEnable" column="is_enable" />
		<result property="areaCode" column="area_code" />
	</resultMap>
	
	<resultMap type="ProductTemp" id="productTempResultMap">
		<id property="id" column="id" />
		<result property="clientId" column="client_id" />
		<result property="merchantId" column="merchant_id" />
		<result property="orgCode" column="org_code" />
		<result property="productId" column="product_id" />
		<result property="isMarketable" column="is_marketable" />
		<result property="createTime" column="create_time" />
		<result property="rackTime" column="rack_time" />
		<result property="downTime" column="down_time" />
		<result property="startTime" column="start_time" />
		<result property="endTime" column="end_time" />
		<result property="type" column="type" />
		<result property="deliveryOption" column="delivery_option" />
		<result property="name" column="name" />
		<result property="fullName" column="full_name" />
		<result property="price" column="price" />
		<result property="cost" column="cost" />
		<result property="marketPrice" column="market_price" />
		<result property="store" column="store" />
		<result property="isLimit" column="is_limit" />
		<result property="point" column="point" />
		<result property="briefIntroduction" column="brief_introduction" />
		<result property="introduction" column="introduction" />
		<result property="buyKnow" column="buy_know" />
		<result property="sellCount" column="sell_count" />
		<result property="deliveryMoney" column="delivery_money" />
		<result property="isSeckill" column="is_seckill" />
		<result property="primeval" column="primeval" />
		<result property="photoList" column="photo_list" />
		<result property="categoryTreePath" column="category_tree_path" />
		<result property="merchantName" column="merchant_name" />
		<result property="platType" column="plat_type" />
		<result property="isPoint" column="is_point" />
		<result property="codeUrl" column="code_url" />
		<result property="vipPrice" column="vip_price" />
		<result property="deliveryTime" column="delivery_time" />
		<result property="seoKeyWords" column="seo_keyWords" />
		<result property="afterShop" column="after_shop" />
		<result property="goodFlag" column="good_flag" />
		<result property="expireStartTime" column="expire_start_time" />
		<result property="expireEndTime" column="expire_end_time" />
		<result property="weight" column="weight" />
		<result property="weightUnit" column="weight_unit" />
		<result property="isBest" column="is_best" />
		<result property="orderValue" column="order_value" />
		<result property="proOrgCode" column="province_agency" />
		<result property="cityOrgCode" column="city_agency" />
		<result property="countryOrgCode" column="county_agency" />
		<result property="productSupplier" column="product_supplier" />
		<result property="maxPerOutlet" column="max_per_outlet" />
		<result property="deliveryStartTime" column="delivery_start_time" />
		<result property="deliveryEndTime" column="delivery_end_time" />
		<result property="trueBuyerNumber" column="true_buyer_number" />
		<result property="virtualBuyerNumber" column="virtual_buyer_number" />
		<result property="clusterState" column="cluster_state" />
		<result property="clusterType" column="cluster_type" />
		<result property="auditState" column="audit_state" />
		<result property="auditOrgCode" column="audit_org_code" />
		<result property="auditStartOrgCode" column="audit_start_org_code" />
		<result property="auditEndOrgCode" column="audit_end_org_code" /> 
		<result property="auditStage" column="audit_stage" />
		<result property="auditTime" column="audit_time" />
		<result property="auditComment" column="audit_comment" />
		<result property="reviewStaff" column="review_staff" />
		<result property="auditStaff" column="audit_staff" />
		<result property="buyLimit" column="buy_limit" />
		<result property="isHistory" column="is_history" />
	</resultMap>
	
	<!-- 添加  Product -->
	<insert id="addProduct" parameterType="Product" useGeneratedKeys="true" keyProperty="id">
		<![CDATA[
			insert into cb_product (
				create_time,client_id,merchant_id,merchant_name,org_code,product_id,is_marketable,rack_time,down_time,type,delivery_option,name,full_name,price,cost,market_price,
				weight,weight_unit,store,is_best,is_limit,point,brief_introduction,introduction,buy_know,audit_state,audit_time,audit_org_code,audit_stage,audit_comment,
				review_staff,audit_staff,order_value,sell_count,start_time,end_time,delivery_money,is_seckill,province_agency,city_agency,county_agency,audit_start_org_code,
				audit_end_org_code,category_tree_path,plat_type,is_point,code_url 
			) values (
				#{createTime},#{clientId},#{merchantId},#{merchantName},#{orgCode},#{productId},#{isMarketable},#{rackTime},#{downTime},#{type},#{deliveryOption},#{name},#{fullName},#{price},#{cost},#{marketPrice},
				#{weight},#{weightUnit},#{store},#{isBest},#{isLimit},#{point},#{briefIntroduction},#{introduction},#{buyKnow},#{auditState},#{auditTime},#{auditOrgCode},#{auditStage},#{auditComment},
				#{reviewStaff},#{auditStaff},#{orderValue},#{sellCount},#{startTime},#{endTime},#{deliveryMoney},#{isSeckill},#{proOrgCode},#{cityOrgCode},#{countryOrgCode},
				#{auditStartOrgCode},#{auditEndOrgCode},#{categoryTreePath},#{platType},#{isPoint},#{codeUrl}  
			) 
		]]>
	</insert>


	<!-- 批量添加  Product -->
	<insert id="addProductByBatch" parameterType="java.util.List">
		insert into cb_product (
			create_time,client_id,merchant_id,merchant_name,org_code,product_id,is_marketable,rack_time,down_time,type,delivery_option,name,full_name,price,cost,market_price,
				weight,weight_unit,store,is_best,is_limit,point,brief_introduction,introduction,buy_know,audit_state,audit_time,audit_org_code,audit_stage,
				review_staff,audit_staff,order_value,sell_count,start_time,end_time,delivery_money,is_seckill,province_agency,city_agency,county_agency,audit_start_org_code,audit_end_org_code,category_tree_path 
		) values 
		<foreach collection="list" item="item" index="index" separator=",">
			(#{item.createTime},#{item.clientId},#{item.merchantId},#{item.merchantName},#{item.orgCode},#{item.productId},#{item.isMarketable},#{item.rackTime},#{item.downTime},#{item.type},#{item.deliveryOption},#{item.name},#{item.fullName},#{item.price},#{item.cost},#{item.marketPrice},
				#{item.weight},#{item.weightUnit},#{item.store},#{item.isBest},#{item.isLimit},#{item.point},#{item.briefIntroduction},#{item.introduction},#{item.buyKnow},#{item.auditState},#{item.auditTime},#{item.auditOrgCode},#{item.auditStage},
				#{item.reviewStaff},#{item.auditStaff},#{item.orderValue},#{item.sellCount},#{item.startTime},#{item.endTime},#{item.deliveryMoney},#{item.isSeckill},#{item.proOrgCode},#{item.cityOrgCode},#{item.countryOrgCode},#{item.countryOrgCode},#{item.auditStartOrgCode},#{item.auditEndOrgCode},#{item.categoryTreePath})
		</foreach>
	</insert>
	
	
	<!-- 添加  ProductGroup -->
	<insert id="addProductGroup" parameterType="ProductGroup" useGeneratedKeys="true" keyProperty="id">
		<![CDATA[
			insert into cb_product_group (
				create_time,client_id,product_id,true_buyer_number,virtual_buyer_number,expire_start_time,expire_end_time
			) values (
				#{createTime},#{clientId},#{productId},#{trueBuyerNumber},#{virtualBuyerNumber},#{expireStartTime},#{expireEndTime}
			) 
		]]>
	</insert>


	<!-- 批量添加  ProductGroup -->
	<insert id="addProductGroupByBatch" parameterType="java.util.List">
		insert into cb_product_group (
			create_time,client_id,product_id,true_buyer_number,virtual_buyer_number,expire_start_time,expire_end_time
		) values 
		<foreach collection="list" item="item" index="index" separator=",">
			(#{item.createTime},#{item.clientId},#{item.productId},#{item.trueBuyerNumber},#{item.virtualBuyerNumber},#{item.expireStartTime},#{item.expireEndTime})
		</foreach>
	</insert>
	
	
	<!-- 添加  ProductPresell -->
	<insert id="addProductPresell" parameterType="ProductPresell" useGeneratedKeys="true" keyProperty="id">
		<![CDATA[
			insert into cb_product_presell (
				create_time,client_id,product_id,product_supplier,max_per_outlet,delivery_start_time,delivery_end_time,true_buyer_number,virtual_buyer_number,cluster_state,cluster_type,expire_start_time,expire_end_time
			) values (
				#{createTime},#{clientId},#{productId},#{productSupplier},#{maxPerOutlet},#{deliveryStartTime},#{deliveryEndTime},#{trueBuyerNumber},#{virtualBuyerNumber},#{clusterState},#{clusterType},#{expireStartTime},#{expireEndTime}
			) 
		]]>
	</insert>


	<!-- 批量添加  ProductPresell -->
	<insert id="addProductPresellByBatch" parameterType="java.util.List">
		insert into cb_product_presell (
			create_time,client_id,product_id,product_supplier,max_per_outlet,delivery_start_time,delivery_end_time,true_buyer_number,virtual_buyer_number,cluster_state,cluster_type,expire_start_time,expire_end_time
		) values 
		<foreach collection="list" item="item" index="index" separator=",">
			(#{item.createTime},#{item.clientId},#{item.productId},#{item.productSupplier},#{item.maxPerOutlet},#{item.deliveryStartTime},#{item.deliveryEndTime},#{item.trueBuyerNumber},#{item.virtualBuyerNumber},#{item.clusterState},#{item.clusterType},#{item.expireStartTime},#{item.expireEndTime})
		</foreach>
	</insert>


	<!-- 删除  Product -->
	<update id="deleteLogicProduct" parameterType="Product">
		update cb_product set is_marketable = #{isMarketable} 
		where client_id = #{clientId} AND product_id = #{productId}
		<if test="merchantId != null and merchantId !=''">
			AND merchant_id = #{merchantId}
		</if>
	</update>
	

	<!-- 修改  Product -->
	<update id="updateProduct" parameterType="Product">
		update cb_product 
		<set>
		<if test="auditState != null " >
		     audit_state=#{auditState}, 
		</if>
		<if test="rackTime != null " >
		     rack_time = #{rackTime}, 
		</if>
		<if test="downTime != null " >
		     down_time = #{downTime}, 
		</if>
		<if test="isMarketable != null " >
              is_marketable = #{isMarketable}, 
		</if>
		<if test="proOrgCode!=null">
              province_agency = #{proOrgCode}, 
		</if>
		<if test="cityOrgCode!=null">
              city_agency = #{cityOrgCode}, 
		</if>
		<if test="countryOrgCode!=null">
              county_agency = #{countryOrgCode}, 
		</if>
		<if test="type!=null">
             type = #{type}, 
		</if>
		<if test="deliveryOption!=null">
             delivery_option = #{deliveryOption}, 
		</if>
		<if test="name!=null">
             name = #{name}, 
		</if>
		<if test="fullName!=null">
             full_name = #{fullName}, 
		</if>
		<if test="price!=null">
             price = #{price}, 
		</if>
		<if test="cost!=null">
             cost = #{cost}, 
		</if>
		<if test="marketPrice!=null">
             market_price = #{marketPrice}, 
		</if>
		<if test="store!=null">
             store = #{store}, 
		</if>
		<if test="weight!=null">
             weight = #{weight}, 
		</if>
		<if test="weightUnit!=null">
             weight_unit = #{weightUnit}, 
		</if>
		<if test="isBest!=null">
             is_best = #{isBest}, 
		</if>
		<if test="isLimit!=null">
             is_limit = #{isLimit}, 
		</if>
		<if test="briefIntroduction!=null">
             brief_introduction = #{briefIntroduction}, 
		</if>
		<if test="introduction!=null">
             introduction = #{introduction}, 
		</if>
		<if test="buyKnow!=null">
             buy_know = #{buyKnow}, 
		</if>
		<if test="orderValue!=null">
             order_value = #{orderValue}, 
		</if>
		<if test="isSeckill!=null">
             is_seckill = #{isSeckill}, 
		</if>
		<if test="startTime!=null">
             start_time = #{startTime}, 
		</if>
		<if test="endTime!=null">
             end_time = #{endTime}, 
		</if>
		<if test="deliveryMoney!=null">
             delivery_money = #{deliveryMoney}, 
		</if>
		<if test="categoryTreePath!=null">
             category_tree_path=#{categoryTreePath}, 
		</if>
		</set> 
         where product_id = #{productId} AND client_id = #{clientId}
				<if test="merchantId != null and merchantId !=''">
					 AND merchant_id = #{merchantId}
				</if>
	</update>


	<!-- 修改  ProductGroup -->
	<update id="updateProductGroup" parameterType="ProductGroup">
		update cb_product_group set 
            true_buyer_number = #{trueBuyerNumber}
            , virtual_buyer_number = #{virtualBuyerNumber}
            , expire_start_time = #{expireStartTime}
            , expire_end_time = #{expireEndTime}
         where client_id = #{clientId} AND product_id = #{productId}
	</update>


	<!-- 修改  ProductPresell -->
	<update id="updateProductPresell" parameterType="ProductPresell">
		update cb_product_presell set 
             product_supplier = #{productSupplier}
            , max_per_outlet = #{maxPerOutlet}
            , delivery_start_time = #{deliveryStartTime}
            , delivery_end_time = #{deliveryEndTime}
            , true_buyer_number = #{trueBuyerNumber}
            , virtual_buyer_number = #{virtualBuyerNumber}
            , cluster_state = #{clusterState}
            , cluster_type = #{clusterType}
            , expire_start_time = #{expireStartTime}
            , expire_end_time = #{expireEndTime}
          where client_id = #{clientId} AND product_id = #{productId}
	</update>
	
	<!-- 修改商品秒杀标识，不需要审核  Product -->
	<update id="updateProductIsSeckill" parameterType="Product" >
		update cb_product set is_seckill = #{isSeckill}
		<where>
			client_id = #{clientId} and product_id = #{productId}
		</where>
	</update>
	
	<!-- 上下架商品  Product -->
	<update id="updateProductStatus" parameterType="Product">
		update cb_product set is_marketable = #{isMarketable}
			<if test="rackTime != null">
				 , rack_time = #{rackTime}
			</if>
			<if test="downTime != null">
				 , down_time = #{downTime}
			</if>
		 where client_id = #{clientId} AND product_id = #{productId}
			<if test="merchantId != null and merchantId !=''">
				 AND merchant_id = #{merchantId}
			</if>
	</update>
	
	
	<!-- 查询  getProductCount是否存在 -->
	<select id="getProductCount" parameterType="Product" resultType="Integer">
		SELECT COUNT(0) 
		FROM cb_product
		WHERE is_marketable<![CDATA[<>]]>#{isMarketable} 
		<if test="productId != null and productId !=''">
			 AND product_id <![CDATA[<>]]> #{productId}
		</if>
		<if test="clientId != null and clientId !=''">
			 AND client_id = #{clientId}
		</if>
		<if test="merchantId != null and merchantId !=''">
			 AND merchant_id = #{merchantId}
		</if>
		<if test="fullName != null and fullName !=''">
			 AND full_name = trim(#{fullName})
		</if>
		<if test="type != null and type !=''">
			 AND type = #{type}
		</if>																				
	</select>
	
	<!-- 查询  Product -->
	<select id="getProduct" parameterType="Product" resultMap="productViewResultMap">
		SELECT a.id,a.client_id,a.merchant_id,a.merchant_name,a.org_code,a.product_id,a.is_marketable,a.rack_time,a.down_time,a.create_time,a.type,
		a.delivery_option,a.name,a.full_name,a.price,a.cost,a.market_price,a.weight,a.weight_unit,a.store,a.is_best,a.is_limit,a.point,a.brief_introduction,
		a.introduction,a.buy_know,a.audit_state,a.audit_time,a.audit_comment,a.audit_org_code,a.audit_start_org_code,a.audit_end_org_code,a.audit_stage,
		a.review_staff,a.audit_staff,a.order_value,a.sell_count,a.start_time,a.end_time,a.delivery_money,a.is_seckill,a.code_url,a.after_shop 
		FROM cb_product a WHERE a.product_id = #{productId}
			<if test="clientId != null and clientId !=''">
				 AND a.client_id = #{clientId}
			</if>
			<if test="merchantId != null and merchantId !=''">
				 AND a.merchant_id = #{merchantId}
			</if>
			 LIMIT 1 
	</select>
	
	<!-- 查询秒杀商品 -->
	<select id="getSeckillProduct" parameterType="Product" resultMap="productResultMap">
		SELECT product_id,end_time 
		FROM cb_product_seckill 
		WHERE client_id=#{clientId} AND product_id=#{productId} LIMIT 1
	</select>
	
	<!-- 商品管理分页查询 -->
	<select id="findProductListByPage" parameterType="java.util.HashMap" resultMap="productListResultMap" >
		select id,client_id,product_id,merchant_id,type,org_code,name,merchant_name,start_time,end_time,audit_state,is_marketable,
		price,store,market_price,delivery_option,create_time,category_tree_path,is_seckill,audit_comment,rack_time,audit_time,audit_staff   
		from cb_product  
		<where>
		<if test="p.clientId != null and p.clientId !=''">
			 AND client_id = #{p.clientId}
		</if>
		<if test="p.type != null and p.type != ''">
			 AND type = #{p.type}
		</if>
		<if test="p.proOrgCode != null and p.proOrgCode != ''">
			 AND province_agency = #{p.proOrgCode}
		</if>
		<if test="p.cityOrgCode != null and p.cityOrgCode != ''">
			 AND city_agency = #{p.cityOrgCode}
		</if>
		<if test="p.countryOrgCode != null and p.countryOrgCode != ''">
			 AND county_agency = #{p.countryOrgCode}
		</if>
		<if test="p.orgCode != null and p.orgCode != ''">
			 AND org_code = #{p.orgCode}
		</if>
		<if test="param!= null" >
      	 AND (
          	<foreach collection="param" item="item" index="key" separator="or">
               ${key} in 
               <foreach collection="item" item="item" open="(" separator="," close=")">
                      #{item}
               </foreach>
          	</foreach>
          	)
      	</if>
		<if test="p.auditState != null and p.auditState != ''">
			 AND audit_state = #{p.auditState}
		</if>
		<if test="p.filterAuditState != null and p.filterAuditState != ''">
			<![CDATA[
			 AND audit_state<>#{p.filterAuditState}
			]]>
		</if>
		<if test="p.auditOrgCode != null and p.auditOrgCode != ''">
			 AND audit_org_code = #{p.auditOrgCode}
		</if>
		<if test="p.isSeckill != null and p.isSeckill != ''">
			 AND is_seckill = #{p.isSeckill}
		</if>
		<if test="p.isMarketable =='0'.toString()">
			 AND is_marketable = '0'
		</if>
		<if test="p.isMarketable =='1'.toString()">
			 AND is_marketable = '1'
		</if>
		<if test="p.isMarketable =='2'.toString() or p.isMarketable =='4'.toString()">
			 AND (is_marketable = '2' OR is_marketable = '4')
		</if>
		<if test="p.merchantId != null and p.merchantId != ''">
			 AND merchant_id = #{p.merchantId}
		</if>
		<if test="p.merchantName != null and p.merchantName != ''">
			 AND merchant_name LIKE CONCAT('%',#{p.merchantName},'%')
		</if>
		<if test="p.name != null and p.name != ''">
			 AND name LIKE CONCAT('%',#{p.name},'%' )
		</if>
		<if test="p.filterStatuts != null and p.filterStatuts != ''">
			<![CDATA[
			 AND is_marketable<>#{p.filterStatuts}
			]]>
		</if>
		<if test="p.categoryTreePath != null and p.categoryTreePath != ''">
			 AND category_tree_path LIKE CONCAT(#{p.categoryTreePath},'%') 
		</if>
		<if test="p.startTimeStart != null and p.startTimeEnd!=null and p.endTimeStart != null and p.endTimeEnd != null" >
			<![CDATA[
			 AND (start_time <= #{p.startTimeStart} or start_time <= #{p.startTimeEnd})
			]]>
		</if>

		<if test="p.startTimeStart != null and p.startTimeEnd!=null and p.endTimeStart != null and p.endTimeEnd != null">
			<![CDATA[
			 AND (end_time >= #{p.endTimeStart} or end_time >= #{p.endTimeEnd})
			]]>
		</if>
		<if test="p.startTimeStart != null and p.startTimeEnd!=null and p.endTimeStart == null and p.endTimeEnd == null">
			<![CDATA[
			 AND start_time >= #{p.startTimeStart} AND start_time <= #{p.startTimeEnd}
			]]>
		</if>
		<if test="p.priceStart != null">
			<![CDATA[
			 AND price >= #{p.priceStart}
			]]>
		</if>
		<if test="p.priceEnd != null ">
			<![CDATA[
			 AND price <= #{p.priceEnd}
			]]>
		</if>
		<if test="p.typeList!=null and p.typeList.size>0">
             AND type IN  
             <foreach collection="p.typeList" item="item" open="(" separator="," close=")">
                      #{item}
             </foreach>
        </if>
        <if test="p.auditStartTime != null ">
			<![CDATA[
			 AND audit_time >= #{p.auditStartTime}
			]]>
		</if>
		<if test="p.auditEndTime != null">
			<![CDATA[
			 AND audit_time <= #{p.auditEndTime}
			]]>
		</if>
		<if test="p.excludePlatType != null and p.excludePlatType != ''">
			 <![CDATA[
			 AND plat_type <> #{p.excludePlatType} 
			 ]]>
		</if>
		</where>
      	<if test="p.orderFileds != null and p.orderFileds.size >0">
      	 order by
          	<foreach collection="p.orderFileds" item="item" index="key" separator=",">
               ${key} ${item} 
          	</foreach>
      	</if>
	</select>
	
	
	<!-- 查询  敏感词 -->
	<select id="findSenseWords" resultMap="senseWordResultMap">
		SELECT id,word,is_enable FROM cb_boss_sense_words WHERE is_enable=1
	</select>
	
	<!-- 更新评分 -->
	<update id="updatePoint" parameterType="Product">
    	update cb_product set point = if(point>0,<![CDATA[(]]>#{point}+point<![CDATA[)]]>/2,#{point})
    	WHERE product_id = #{productId} 
    	<if test="clientId != null and clientId != ''">
    		AND client_id = #{clientId} 
    	</if>
  	</update>
	
	<!-- 审核  Product -->
	<update id="updateAuditProduct" parameterType="Product">
		update cb_product set audit_time = #{auditTime} 
            , audit_comment = #{auditComment}
			, audit_state = #{auditState}
			, audit_org_code = #{auditOrgCode}
			, audit_stage = #{auditStage}
			, review_staff = #{reviewStaff}
			, audit_staff = #{auditStaff}
		 where product_id = #{productId}
				<if test="merchantId != null and merchantId != ''">
					 AND merchant_id = #{merchantId}
				</if>
				<if test="clientId != null and clientId != ''">
					 AND client_id = #{clientId}
				</if>
	</update>
	
	
	<!-- 查询  Outlet -->
	<select id="findOutlets" parameterType="Map" resultMap="outletResultMap">
		<![CDATA[
		SELECT 
            o.id,o.create_time,o.client_id,o.merchant_id,o.outlet_id,o.area_id,o.outlet_name,o.outlet_fullname,o.outlet_status,o.address,a.parent_id
        FROM cb_outlet o
        LEFT JOIN cb_area a ON o.area_id=a.id AND a.is_enable=1
        WHERE o.is_enable = 1
        ]]>
        <if test="clientId != null and clientId != ''">
             AND o.client_id = #{clientId}
        </if>
        <if test="outletId != null and outletId != ''">
             AND o.outlet_id = #{outletId}
        </if>
        <if test="areaId != null">
             AND o.area_id = #{areaId}
        </if>
        <if test="outletIds!=null and outletIds.size>0">
             AND o.outlet_id IN  
             <foreach collection="outletIds" item="item" open="(" separator="," close=")">
                      #{item}
             </foreach>
        </if>
	</select>
	
	<update id="updateAuditProductBatch" parameterType="Product">
		update cb_product 
		<set>
	 	audit_state = #{auditState}
		</set>
		where client_id=#{clientId} and product_id=#{productId}
	</update>
	
	<!-- 查询赠送积分活动 -->
	<select id="getPointActivities" parameterType="Map" resultMap="activitiesResultMap">
		<![CDATA[
		SELECT 
            id,client_id,activities_name,points,status  
        FROM cb_activities 
		]]>
		<where>
			<if test="activitiesIds!=null and activitiesIds.size>0">
             	AND id IN  
             	<foreach collection="activitiesIds" item="item" open="(" separator="," close=")">
                      #{item}
             	</foreach>
        	</if>
        	<if test="id != null">
             	AND id = #{id} 
        	</if>
			<if test="clientId != null and clientId != ''">
             	AND client_id = #{clientId} 
        	</if>
        	<if test="status != null">
             	AND status = #{status} 
        	</if>
        </where>
	</select>

	<!-- 查询一个赠送积分活动 -->
	<select id="findPoints" parameterType="Long" resultMap="activitiesResultMap">
		<![CDATA[
		SELECT 
            id,client_id,activities_name,points,status  
        FROM cb_activities WHERE id = #{id} AND status <>'3' LIMIT 1 
		]]>
	</select>
	
	<!-- 更新该条送积分活动已经绑定的商品数量 -->
	<update id="updatePointsCount" parameterType="Map">
		UPDATE cb_activities SET count = count+#{count}  
		WHERE id = #{id}
	</update>
	
	<!-- 重置该条送积分活动已经绑定的商品数量-->
	<update id="resetPointsCount" parameterType="Map">
		UPDATE cb_activities SET count = #{count}  
		WHERE id = #{id}
	</update>
	
	<!-- 重置该条送积分活动已经绑定的商品数量-->
	<update id="updateProductIsPoint" parameterType="Product">
		UPDATE cb_product SET is_point = #{isPoint}  
		WHERE product_id = #{productId}
	</update>
	
	<!-- 查询机构表 -->
	<select id="findOrgs"  parameterType="Map" resultMap="bankOrgResultMap">
		select id,client_id,org_code,org_name,merchant_id,outlet_id,area_id,province_agency,city_agency,county_agency,org_level 
		from cb_org
		WHERE is_enable=1 
		<if test="orgCode != null and orgCode != ''">
             AND org_code = #{orgCode}
        </if>
        <if test="clientId != null and clientId != ''">
             AND client_id = #{clientId}
        </if>
        <if test="outletId != null and outletId != ''">
             AND outlet_id = #{outletId}
        </if>
        <if test="areaId != null">
             AND area_id = #{areaId} 
        </if>
        <if test="outletIds!=null and outletIds.size>0">
             AND outlet_id IN  
             <foreach collection="outletIds" item="item" open="(" separator="," close=")">
                      #{item}
             </foreach>
        </if>
	</select>
	
	
	<!-- 查询  Product -->
	<select id="getProductByProductId" parameterType="Product" resultMap="productResultMap">
		SELECT id,client_id,merchant_id,org_code,product_id,is_marketable,create_time,rack_time,down_time,start_time,end_time,type,
			delivery_option,name,full_name,price,cost,market_price,weight,weight_unit,store,is_best,is_limit,point,brief_introduction,
			introduction,buy_know,audit_state,audit_org_code,audit_start_org_code,audit_end_org_code,audit_stage,audit_time,audit_comment,
			review_staff,audit_staff,order_value,sell_count,delivery_money,is_seckill,province_agency,city_agency,county_agency,
			category_tree_path,merchant_name,vip_price,delivery_time,seo_keyWords,after_shop,good_flag 
		FROM cb_product WHERE product_id = #{productId}
		<if test="clientId != null and clientId !=''">
		     AND client_id = #{clientId}
		</if>
		<if test="merchantId != null and merchantId !=''">
			 AND merchant_id = #{merchantId}
		</if>
		<if test="type != null and type !=''">
			 AND type = #{type}
		</if>
	</select>
	
	<!-- 查询  ProductGroup -->
	<select id="getProductGroupByProductId" parameterType="Product" resultMap="productGroupResultMap">
		SELECT id,client_id,create_time,product_id,true_buyer_number,virtual_buyer_number,expire_start_time,expire_end_time    
		FROM cb_product_group WHERE product_id = #{productId} 
		<if test="clientId != null and clientId !=''">
		     AND client_id = #{clientId}
		</if>
		 LIMIT 1
	</select>
	
	<!-- 查询  ProductPresell -->
	<select id="getProductPresellByProductId" parameterType="Product" resultMap="productPresellResultMap">
		SELECT id,client_id,create_time,product_id,product_supplier,max_per_outlet,delivery_start_time,delivery_end_time,
			   true_buyer_number,virtual_buyer_number,cluster_state,cluster_type,expire_start_time,expire_end_time    
		FROM cb_product_presell WHERE product_id = #{productId} 
		<if test="clientId != null and clientId !=''">
		     AND client_id = #{clientId} 
		</if>
		 LIMIT 1
	</select>
	
	<!-- 更新商品状态 -->
	<update id="updateProductsStatus" parameterType="Map">
		update cb_product set is_marketable = #{isMarketable}
			<if test="rackTime != null and downTime == null">
				 , rack_time = #{rackTime}
			</if>
			<if test="rackTime == null and downTime != null">
				 , down_time = #{downTime}
			</if>
		<where>
			<if test="clientId != null and clientId !=''">
				 AND client_id = #{clientId} 
			</if>
			<if test="merchantId != null and merchantId !=''">
				 AND merchant_id = #{merchantId}
			</if>
			<if test="oldIsMarketable != null and oldIsMarketable !=''">
				 AND is_marketable = #{oldIsMarketable}
			</if>
			<if test="productId != null and productId !=''">
				 AND product_id = #{productId}
			</if>
			<if test="productIds!=null and productIds.size>0">
				 AND product_id IN  
				 <foreach collection="productIds" item="item" open="(" separator="," close=")">
                      #{item}
				 </foreach>
			</if>
		</where>
	</update>
	
	<!-- 查询  Product -->
	<select id="getProducts" parameterType="Map" resultMap="productResultMap">
		SELECT id,client_id,merchant_id,org_code,product_id,is_marketable,create_time,rack_time,down_time,start_time,end_time,type,
			delivery_option,name,full_name,price,cost,market_price,weight,weight_unit,store,is_best,is_limit,point,brief_introduction,
			introduction,buy_know,audit_state,audit_org_code,audit_start_org_code,audit_end_org_code,audit_stage,audit_time,audit_comment,
			review_staff,audit_staff,order_value,sell_count,delivery_money,is_seckill,province_agency,city_agency,county_agency,
			category_tree_path,merchant_name      
		FROM cb_product 
		<where>
			<if test="clientId != null and clientId !=''">
				 AND client_id = #{clientId} 
			</if>
			<if test="merchantId != null and merchantId !=''">
				 AND merchant_id = #{merchantId}
			</if>
			<if test="productId != null and productId !=''">
				 AND product_id = #{productId}
			</if>

			<if test="isUpdate != null and isUpdate !=''">
				 AND (rack_time  is not null or  down_time  is  not null)
			</if>
			<if test="isMarketable != null and isMarketable !=''">
				 AND is_marketable = #{isMarketable}
			</if>
			<if test="startTime != null  and endTime != null" >
			<![CDATA[
			  and   create_time BETWEEN  #{startTime} and #{endTime}
			   ]]>
		    </if>
			<if test="productIds!=null and productIds.size>0">
				 AND product_id IN  
				 <foreach collection="productIds" item="item" open="(" separator="," close=")">
                      #{item}
				 </foreach>
			</if>
		</where>
	</select>
	
	<!-- 批量删除  Product -->
	<update id="deleteLogicProducts"  parameterType="Map">
		update cb_product set is_marketable = #{isMarketable} 
		<where>
			<if test="clientId != null and clientId !=''">
				 AND client_id = #{clientId} 
			</if>
			<if test="merchantId != null and merchantId !=''">
				 AND merchant_id = #{merchantId}
			</if>
			<if test="productId != null and productId !=''">
				 AND product_id = #{productId}
			</if>
			<if test="productIds!=null and productIds.size>0">
				 AND product_id IN  
				 <foreach collection="productIds" item="item" open="(" separator="," close=")">
                      #{item}
				 </foreach>
			</if>
		</where>
	</update>


	<!-- 修改  ProductGroup -->
	<update id="updateProductGroupBase" parameterType="Map">
		update cb_product_group 
		<set>
			<if test="expireStartTime != null">
				expire_start_time = #{expireStartTime},
			</if>
			<if test="expireEndTime != null">
				expire_end_time = #{expireEndTime},
			</if>
		</set>
         where product_id = #{productId}
			<if test="clientId != null and clientId !=''">
				AND client_id = #{clientId}
			</if>
	</update>

	<!-- 修改  ProductPresell -->
	<update id="updateProductPresellBase" parameterType="Map">
		update cb_product_presell 
		<set>
			<if test="expireStartTime != null">
				expire_start_time = #{expireStartTime},
			</if>
			<if test="expireEndTime != null">
				expire_end_time = #{expireEndTime},
			</if>
		</set>
         where product_id = #{productId}
			<if test="clientId != null and clientId !=''">
				AND client_id = #{clientId}
			</if>
	</update>
	
	<!-- 查询  Area -->
	<select id="findAreaByCode" parameterType="Map" resultMap="areaResultMap">
		SELECT id,name,vague_letter,tree_path,parent_id,is_enable,tree_path_name,area_code
        FROM cb_area 
        WHERE area_code = #{areaCode} AND is_enable=1 
        <if test="clientId != null and clientId !=''">
			 AND client_id = #{clientId} 
		</if>
         LIMIT 1
	</select>
	
	<!-- 更新商品审核状态 禁用商户时 将商品的 该普通商户的待审核状态变成未提交 启用商户时 将除团购以外的商品的 该普通商户的未提交状态变成待审核 -->
	<update id="updateProductAuditState" parameterType="Map">
		update cb_product set audit_state = #{auditState} 
		<where>
			<if test="clientId != null and clientId !=''">
				 AND client_id = #{clientId} 
			</if>
			<if test="merchantId != null and merchantId !=''">
				 AND merchant_id = #{merchantId}
			</if>
			<if test="oldAuditState != null and oldAuditState !=''">
				 AND audit_state = #{oldAuditState}
			</if>
			<if test="type != null and type !=''">
				 AND type = #{type}
			</if>
			<if test="filterType != null and filterType !=''">
				 AND type <![CDATA[<>]]> #{filterType}
			</if>
		</where>
	</update>
	
	<select id="findPointRate" parameterType="String" resultType="String">
		SELECT point_rate FROM cb_client_payment_channel  WHERE client_id=#{clientId} AND TYPE=2 AND is_delete=0 LIMIT 1
	</select>
	
	<!-- 查询  Outlet -->
	<select id="findOutletById" parameterType="Map" resultMap="outletResultMap">
		<![CDATA[
		SELECT 
            o.id,o.client_id,o.outlet_id,o.outlet_name,o.address,o.phone,o.area_id,a.name,a.tree_path,org.org_code 
        FROM cb_outlet o
        LEFT JOIN cb_area a ON o.area_id=a.id AND a.is_enable=1
        LEFT JOIN cb_org org ON org.outlet_id=o.outlet_id 
        WHERE o.is_enable = 1
        ]]>
        <if test="outletId != null and outletId != ''">
             AND o.outlet_id = #{outletId}
        </if>
        <if test="clientId != null and clientId != ''">
             AND o.client_id = #{clientId}
        </if>
         LIMIT 1
	</select>

	<update id="updateProductCodeUrl" parameterType="Map">
		update cb_product set code_url = #{codeUrl} 
		<where>
			<if test="clientId != null and clientId !=''">
				 AND client_id = #{clientId} 
			</if>
			<if test="productId != null and productId !=''">
				 AND product_id = #{productId}
			</if>

		</where>
	</update>
	
	<select id="findProductListByIds" parameterType="Map" resultMap="productResultMap">
		<![CDATA[
		SELECT 
         		SELECT id,client_id,merchant_id,merchant_name,org_code,product_id,create_time,name,
         		full_name,price,market_price,sell_count,start_time,end_time,code_url
        FROM cb_product 
		]]>
		<where>
			<if test="productIds!=null and productIds.size>0">
             	AND product_id IN  
             	<foreach collection="productIds" item="item" open="(" separator="," close=")">
                      #{item}
             	</foreach>
        	</if>
        </where>
	</select>

	
	<!-- 销售期已到期自动下架 -->
	<select id="findSaleEndProductList" parameterType="java.util.HashMap" resultMap="productListResultMap" >
		<![CDATA[
		SELECT id,client_id,product_id,merchant_id 
		FROM cb_product WHERE type = #{type} AND is_marketable = #{isMarketable} AND end_time <= #{endTimeEnd}
		]]>
	</select>

	
	<!-- 更新商品状态 -->
	<update id="updateSaleEndProductStatus" parameterType="Map">
		<![CDATA[
		update cb_product set is_marketable = #{newIsMarketable} , down_time = #{downTime} 
		WHERE type = #{type} AND is_marketable = #{isMarketable} AND end_time <= #{endTimeEnd}
		]]>		
	</update>
	 <update id="auditProduct" parameterType="Product">
		update cb_product 
		<set>
			<if test="auditTime != null">
				 audit_time = #{auditTime}, 
			</if>
			<if test="auditComment != null">
				 audit_comment = #{auditComment},
			</if>
			<if test="auditState != null">
				 audit_state = #{auditState},
			</if>
			<if test="auditStage != null">
				 audit_stage = #{auditStage},
			</if>
			<if test="reviewStaff != null">
				 review_staff = #{reviewStaff},
			</if>
			<if test="auditStaff != null">
				 audit_staff = #{auditStaff},
			</if>
			<if test="isMarketable != null">
				 is_marketable = #{isMarketable}, 
			</if>
		</set>
		<where>
			<if test="auditId != null">
				 AND product_id = #{auditId}
			</if>
			<if test="clientId != null">
				 AND client_id = #{clientId}
			</if>
			<if test="merchantId != null">
				 AND merchant_id = #{merchantId}
			</if>
		</where>
	</update>

	<!-- 商品所属商户id查询 -->
	<select id="findProductMerchantIds" parameterType="java.util.HashMap" resultType="String" >
		SELECT DISTINCT merchant_id 
		FROM cb_product  
		<where>
		<if test="clientId != null and clientId !=''">
			 AND client_id = #{clientId}
		</if>
		<if test="type != null and type != ''">
			 AND type = #{type}
		</if>
		<if test="isMarketable != null and isMarketable != ''">
			 AND is_marketable = #{isMarketable}
		</if>
		<if test="name != null and fullName != null">
			 AND (
			 name LIKE CONCAT('%',#{name},'%')
			 or full_name LIKE CONCAT('%',#{fullName},'%')
			 )
		</if>
		<if test="name == null and fullName != null">
			 AND full_name LIKE CONCAT('%',#{fullName},'%')
		</if>
		<if test="name != null and fullName == null">
			 AND name LIKE CONCAT('%',#{name},'%')
		</if>
		<if test="categoryTreePath != null and categoryTreePath != ''">
			 AND category_tree_path LIKE CONCAT(#{categoryTreePath},'%')
		</if>
		<if test="endTimeStart != null">
			<![CDATA[
			 AND end_time >= #{endTimeStart}
			]]>
		</if>
		<if test="createTimeStart != null">
			<![CDATA[
			 AND create_time >= #{createTimeStart} 
			]]>
		</if>
		</where>
	</select>

	<!-- 增加精品商城商品 -->
	<insert id="addGoods" parameterType="Product" useGeneratedKeys="true" keyProperty="id">
		<![CDATA[
			insert into cb_product (
				create_time,client_id,merchant_id,merchant_name,product_id,is_marketable,type,delivery_option,name,full_name,price,market_price,
				store,is_best,is_limit,point,brief_introduction,introduction,buy_know,order_value,sell_count,delivery_money,is_seckill,
				category_tree_path,plat_type,is_point,delivery_time,seo_keyWords,after_shop,vip_price,good_flag,org_code,audit_org_code,
				audit_start_org_code,audit_end_org_code,audit_state 
			) values (
				#{createTime},#{clientId},#{merchantId},#{merchantName},#{productId},#{isMarketable},#{type},#{deliveryOption},#{name},#{fullName},#{price},#{marketPrice},
				#{store},#{isBest},#{isLimit},#{point},#{briefIntroduction},#{introduction},#{buyKnow},#{orderValue},#{sellCount},#{deliveryMoney},#{isSeckill},
				#{categoryTreePath},#{platType},#{isPoint},#{deliveryTime},#{seoKeyWords},#{afterShop},#{vipPrice},#{goodFlag},#{orgCode},
				#{auditOrgCode},#{auditStartOrgCode},#{auditEndOrgCode},#{auditState}  
			) 
		]]>
	</insert>
	
	<!-- 修改精品商城商品 -->
	<update id="updateGoods" parameterType="Product">
		update cb_product 
		set seo_keyWords = #{seoKeyWords},
		vip_price = #{vipPrice}, 
		store = #{store}, 
		delivery_time = #{deliveryTime} 
		<if test="name!=null">
             , name = #{name}
		</if>
		<if test="fullName!=null">
             , full_name = #{fullName}
		</if>
		<if test="price!=null">
             , price = #{price}
		</if>
		<if test="marketPrice!=null">
             , market_price = #{marketPrice}
		</if>
		<if test="isLimit!=null">
             , is_limit = #{isLimit}
		</if>
		<if test="briefIntroduction!=null">
             , brief_introduction = #{briefIntroduction}
		</if>
		<if test="introduction!=null">
             , introduction = #{introduction}
		</if>
		<if test="buyKnow!=null">
             , buy_know = #{buyKnow}
		</if>
		<if test="merchantId != null">
             , merchant_id = #{merchantId}
		</if>
		<if test="merchantName != null">
             , merchant_name = #{merchantName}
		</if>
		<if test="afterShop != null">
             , after_shop = #{afterShop}
		</if>
		<if test="categoryTreePath!=null">
             ,category_tree_path=#{categoryTreePath} 
		</if>
		<if test="deliveryOption!=null">
             , delivery_option = #{deliveryOption} 
		</if>
		<if test="goodFlag != null">
             , good_flag = #{goodFlag}
		</if>
		<if test="isSeckill!=null">
             , is_seckill  = #{isSeckill}
		</if>
         where product_id = #{productId}
	</update>
	
	<!-- 上下架精品商城商品 -->
	<update id="updateGoodsStatus" parameterType="Product">
		update cb_product set is_marketable = #{isMarketable}
			<if test="rackTime != null">
				 , rack_time = #{rackTime}
			</if>
			<if test="downTime != null">
				 , down_time = #{downTime}
			</if>
		 where product_id = #{productId}
	</update>
	
	
	<!-- boss查询精品商城商品列表分页查询 -->
	<select id="findGoodsListByPage" parameterType="java.util.HashMap" resultMap="productResultMap" >
		select id,product_id,create_time,name,full_name,price,vip_price,market_price,is_marketable,client_id,type,merchant_id,merchant_name,start_time,end_time,store,is_seckill 
		from cb_product  
		<where>
		<if test="p.productId != null and p.productId != ''">
			 AND product_id LIKE CONCAT('%',#{p.productId},'%' )
		</if>
		<if test="p.clientId != null and p.clientId !=''">
			 AND client_id = #{p.clientId}
		</if>
		<if test="p.type != null and p.type != ''">
			 AND type = #{p.type}
		</if>
		<if test="p.auditState != null and p.auditState != ''">
			 AND audit_state = #{p.auditState}
		</if>
		<if test="p.isSeckill != null and p.isSeckill != ''">
			 AND is_seckill = #{p.isSeckill}
		</if>
		<if test="p.isMarketable =='0'.toString()">
			 AND is_marketable = '0'
		</if>
		<if test="p.isMarketable =='1'.toString()">
			 AND is_marketable = '1'
		</if>
		<if test="p.isMarketable =='2'.toString() or p.isMarketable =='4'.toString()">
			 AND (is_marketable = '2' OR is_marketable = '4')
		</if>
		<if test="p.name != null and p.name != ''">
			 AND (name LIKE CONCAT('%',#{p.name},'%' ) or full_name LIKE CONCAT('%',#{p.name},'%' ))
		</if>
		<if test="p.filterStatuts != null and p.filterStatuts != ''">
			<![CDATA[
			 AND is_marketable<>#{p.filterStatuts}
			]]>
		</if>
		<if test="p.categoryTreePath != null and p.categoryTreePath != ''">
			 AND category_tree_path LIKE CONCAT(#{p.categoryTreePath},'%' )
		</if>
		<if test="p.seoKeyWords != null and p.seoKeyWords != ''">
			 AND seo_keyWords LIKE CONCAT('%',#{p.seoKeyWords},'%' )
		</if>
		<if test="p.typeList!=null and p.typeList.size>0">
             AND type IN  
             <foreach collection="p.typeList" item="item" open="(" separator="," close=")">
                      #{item}
             </foreach>
        </if>
		</where>
      	 ORDER BY create_time DESC 
	</select>
	
	<!-- boss查询精品商城商品详情 -->
	<select id="getProductDetail" parameterType="String" resultMap="productResultMap">
		SELECT id,client_id,merchant_id,merchant_name,product_id,type,name,full_name,brief_introduction,price,market_price,
		is_marketable,introduction,buy_know,create_time,type,store,delivery_time,seo_keyWords,after_shop,vip_price,
		category_tree_path,is_seckill  
		FROM cb_product WHERE product_id = #{productId} LIMIT 1 
	</select>
	
	<!-- 添加商品临时表 -->
	<insert id="addTempProduct" parameterType="ProductTemp" useGeneratedKeys="true" keyProperty="id">
		<![CDATA[
			INSERT into cb_product_temp (
				create_time,client_id,merchant_id,merchant_name,org_code,product_id,is_marketable,type,delivery_option,name,
				full_name,price,cost,market_price,store,is_seckill,is_limit,brief_introduction,introduction,buy_know,start_time,
				end_time,delivery_money,category_tree_path,plat_type,is_point,vip_price,expire_start_time,expire_end_time,delivery_time,
				seo_keyWords,after_shop,good_flag,primeval,photo_list,weight,weight_unit,order_value,is_best,province_agency,city_agency,
				county_agency,product_supplier,max_per_outlet,delivery_start_time,delivery_end_time,cluster_state,cluster_type,audit_state,
				buy_limit,is_history,code_url,sell_count,point,audit_comment  
			) VALUES (
				#{createTime},#{clientId},#{merchantId},#{merchantName},#{orgCode},#{productId},#{isMarketable},#{type},#{deliveryOption},#{name},
				#{fullName},#{price},#{cost},#{marketPrice},#{store},#{isSeckill},#{isLimit},#{briefIntroduction},#{introduction},#{buyKnow},#{startTime},
				#{endTime},#{deliveryMoney},#{categoryTreePath},#{platType},#{isPoint},#{vipPrice},#{expireStartTime},#{expireEndTime},#{deliveryTime},
				#{seoKeyWords},#{afterShop},#{goodFlag},#{primeval},#{photoList},#{weight},#{weightUnit},#{orderValue},#{isBest},#{proOrgCode},#{cityOrgCode},
				#{countryOrgCode},#{productSupplier},#{maxPerOutlet},#{deliveryStartTime},#{deliveryEndTime},#{clusterState},#{clusterType},#{auditState},
				#{buyLimit},#{isHistory},#{codeUrl},#{sellCount},#{point},#{auditComment}   
			) 
		]]>
	</insert>
	
	<!-- 查询临时表 -->
	<select id="getAuditingTempProductByProductId" parameterType="String" resultMap="productTempResultMap">
		SELECT create_time,client_id,merchant_id,merchant_name,org_code,product_id,is_marketable,type,delivery_option,name,
			full_name,price,cost,market_price,store,is_seckill,is_limit,brief_introduction,introduction,buy_know,start_time,
			end_time,delivery_money,category_tree_path,plat_type,is_point,vip_price,expire_start_time,expire_end_time,delivery_time,
			seo_keyWords,after_shop,good_flag,primeval,photo_list,weight,weight_unit,order_value,is_best,province_agency,city_agency,
			county_agency,product_supplier,max_per_outlet,delivery_start_time,delivery_end_time,cluster_state,cluster_type,audit_state,
			buy_limit,is_history,code_url,audit_time,audit_comment,review_staff,audit_staff 
		FROM cb_product_temp WHERE product_id = #{productId} AND is_history=false ORDER BY create_time DESC LIMIT 1
	</select>
	
	<!-- 查询临时表审核状态 -->
	<select id="getTempProductByProductIds" parameterType="List" resultMap="productTempResultMap">
		SELECT create_time,client_id,merchant_id,product_id,audit_state  
		FROM cb_product_temp WHERE is_history=false AND product_id IN 
		<foreach collection="productIds" item="item" open="(" separator="," close=")">
                #{item}
		</foreach>
	</select>
	
	<!-- 删除临时表 -->
	<delete id="deleteTempProduct" parameterType="Map">
		DELETE FROM cb_product_temp  
		WHERE product_id = #{productId} AND is_history=false 
	</delete>
	
	<!-- 更新商品审核状态 只能是提交和待审核 -->
	<update id="updateProductAuditStatus" parameterType="Map">
		UPDATE cb_product set audit_state = #{auditState}
		<where>
			<if test="productId != null and productId !=''">
				 AND product_id = #{productId}
			</if>
			<if test="productIds!=null and productIds.size>0">
				 AND product_id IN  
				 <foreach collection="productIds" item="item" open="(" separator="," close=")">
                      #{item}
				 </foreach>
			</if>
			<if test="oldAuditState != null and oldAuditState !=''">
				 AND audit_state = #{oldAuditState}
			</if>
		</where>
	</update>
	
	<!-- 更新临时表商品审核状态 只能是提交和待审核 -->
	<update id="updateTempProductAuditStatus" parameterType="Map">
		UPDATE cb_product_temp set audit_state = #{auditState}
		<where>
			<if test="productId != null and productId !=''">
				 AND product_id = #{productId}
			</if>
			<if test="productIds!=null and productIds.size>0">
				 AND product_id IN  
				 <foreach collection="productIds" item="item" open="(" separator="," close=")">
                      #{item}
				 </foreach>
			</if>
		</where>
	</update>
	
	<!-- 查询  Product -->
	<select id="findProduct" parameterType="String" resultMap="productResultMap">
		SELECT id,client_id,merchant_id,org_code,product_id,is_marketable,create_time,rack_time,down_time,start_time,end_time,type,
			delivery_option,name,full_name,price,cost,market_price,weight,weight_unit,store,is_best,is_limit,point,brief_introduction,
			introduction,buy_know,audit_state,edit_audit_state,audit_time,audit_comment,
			review_staff,audit_staff,order_value,sell_count,delivery_money,is_seckill,
			category_tree_path,merchant_name,code_url,vip_price,delivery_time,seo_keyWords,after_shop,good_flag 
		FROM cb_product WHERE product_id = #{productId} LIMIT 1 
	</select>
	
	<!-- 查询  ProductGroup -->
	<select id="findGroupProduct" parameterType="String" resultMap="productGroupResultMap">
		SELECT id,client_id,create_time,product_id,true_buyer_number,virtual_buyer_number,expire_start_time,expire_end_time    
		FROM cb_product_group WHERE product_id = #{productId} LIMIT 1
	</select>
	
	<!-- 查询  ProductPresell -->
	<select id="findPresellProduct" parameterType="String" resultMap="productPresellResultMap">
		SELECT id,client_id,create_time,product_id,product_supplier,max_per_outlet,delivery_start_time,delivery_end_time,
			   true_buyer_number,virtual_buyer_number,cluster_state,cluster_type,expire_start_time,expire_end_time    
		FROM cb_product_presell WHERE product_id = #{productId} LIMIT 1
	</select>
	
	<!-- 商品管理分页查询 -->
	<select id="findProductsByPage" parameterType="java.util.HashMap" resultMap="productListResultMap" >
		SELECT id,client_id,product_id,merchant_id,type,org_code,name,full_name,merchant_name,start_time,end_time,audit_state,is_marketable,
		price,store,market_price,delivery_option,create_time,category_tree_path,is_seckill,audit_comment,rack_time,audit_time,audit_staff   
		FROM cb_product  
		<where>
		<if test="p.clientId != null and p.clientId !=''">
			 AND client_id = #{p.clientId}
		</if>
		<if test="p.type != null and p.type != ''">
			 AND type = #{p.type}
		</if>
		<if test="p.proOrgCode != null and p.proOrgCode != ''">
			 AND province_agency = #{p.proOrgCode}
		</if>
		<if test="p.cityOrgCode != null and p.cityOrgCode != ''">
			 AND city_agency = #{p.cityOrgCode}
		</if>
		<if test="p.countryOrgCode != null and p.countryOrgCode != ''">
			 AND county_agency = #{p.countryOrgCode}
		</if>
		<if test="p.orgCode != null and p.orgCode != ''">
			 AND org_code = #{p.orgCode}
		</if>
		<if test="param!= null" >
      	 AND (
          	<foreach collection="param" item="item" index="key" separator="or">
               ${key} in 
               <foreach collection="item" item="item" open="(" separator="," close=")">
                      #{item}
               </foreach>
          	</foreach>
          	)
      	</if>
		<if test="p.auditState != null and p.auditState != ''">
			 AND audit_state = #{p.auditState}
		</if>
		<if test="p.filterAuditState != null and p.filterAuditState != ''">
			<![CDATA[
			 AND audit_state<>#{p.filterAuditState}
			]]>
		</if>
		<if test="p.isSeckill != null and p.isSeckill != ''">
			 AND is_seckill = #{p.isSeckill}
		</if>
		<if test="p.isMarketable =='0'.toString()">
			 AND is_marketable = '0'
		</if>
		<if test="p.isMarketable =='1'.toString()">
			 AND is_marketable = '1'
		</if>
		<if test="p.isMarketable =='2'.toString() or p.isMarketable =='4'.toString()">
			 AND (is_marketable = '2' OR is_marketable = '4')
		</if>
		<if test="p.merchantId != null and p.merchantId != ''">
			 AND merchant_id = #{p.merchantId}
		</if>
		<if test="p.merchantName != null and p.merchantName != ''">
			 AND merchant_name LIKE CONCAT('%',#{p.merchantName},'%')
		</if>
		<if test="p.productName != null and p.productName != ''">
			 AND (name LIKE CONCAT('%',#{p.productName},'%' ) or  full_name LIKE CONCAT('%',#{p.productName},'%' ))
		</if>
		<if test="p.filterStatuts != null and p.filterStatuts != ''">
			<![CDATA[
			 AND is_marketable<>#{p.filterStatuts}
			]]>
		</if>
		<if test="p.categoryTreePath != null and p.categoryTreePath != ''">
			 AND category_tree_path LIKE CONCAT(#{p.categoryTreePath},'%') 
		</if>
		<if test="p.startTimeStart != null and p.startTimeEnd != null and p.endTimeStart != null and p.endTimeEnd != null" >
			<![CDATA[
			 AND (start_time <= #{p.startTimeStart} or start_time <= #{p.startTimeEnd})
			 AND (end_time >= #{p.endTimeStart} or end_time >= #{p.endTimeEnd})
			]]>
		</if>
		<if test="p.startTimeStart != null and p.startTimeEnd == null and p.endTimeStart != null and p.endTimeEnd == null">
			<![CDATA[
			 AND end_time >= #{p.endTimeStart}
			]]>
		</if>
		<if test="p.startTimeStart == null and p.startTimeEnd != null and p.endTimeStart == null and p.endTimeEnd != null">
			<![CDATA[
			 AND start_time <= #{p.startTimeEnd}  
			]]>
		</if>
		<if test="p.startTimeStart != null and p.startTimeEnd != null and p.endTimeStart == null and p.endTimeEnd == null">
			<![CDATA[
			 AND start_time >= #{p.startTimeStart} AND start_time <= #{p.startTimeEnd}
			]]>
		</if>
		<if test="p.startTimeStart == null and p.startTimeEnd == null and p.endTimeStart != null and p.endTimeEnd != null">
			<![CDATA[
			 AND end_time >= #{p.endTimeStart} AND end_time <= #{p.endTimeEnd}
			]]>
		</if>
		<if test="p.startTimeStart != null and p.startTimeEnd == null and p.endTimeStart == null and p.endTimeEnd != null">
			<![CDATA[
			 AND start_time >= #{p.startTimeStart} AND end_time <= #{p.endTimeEnd}
			]]>
		</if>
		<if test="p.startTimeStart == null and p.startTimeEnd != null and p.endTimeStart != null and p.endTimeEnd == null">
			<![CDATA[
			 AND start_time <= #{p.startTimeEnd} AND end_time >= #{p.endTimeStart} 
			]]>
		</if>
		<if test="p.priceStart != null">
			<![CDATA[
			 AND price >= #{p.priceStart}
			]]>
		</if>
		<if test="p.priceEnd != null ">
			<![CDATA[
			 AND price <= #{p.priceEnd}
			]]>
		</if>
		<if test="p.typeList!=null and p.typeList.size>0">
             AND type IN  
             <foreach collection="p.typeList" item="item" open="(" separator="," close=")">
                      #{item}
             </foreach>
        </if>
        <if test="p.auditStartTime != null ">
			<![CDATA[
			 AND audit_time >= #{p.auditStartTime}
			]]>
		</if>
		<if test="p.auditEndTime != null">
			<![CDATA[
			 AND audit_time <= #{p.auditEndTime}
			]]>
		</if>
		<if test="p.excludePlatType != null and p.excludePlatType != ''">
			 <![CDATA[
			 AND plat_type <> #{p.excludePlatType} 
			 ]]>
		</if>
		</where>
      	<if test="p.orderFileds != null and p.orderFileds.size >0">
      	 order by
          	<foreach collection="p.orderFileds" item="item" index="key" separator=",">
               ${key} ${item} 
          	</foreach>
      	</if>
	</select>
	
	<!-- 查询正在审核的商品信息 -->
	<select id="getAuditingProductById" parameterType="Product" resultMap="productResultMap">
		SELECT id,client_id,merchant_id,product_id,audit_state,audit_stage,rack_time,down_time  
		FROM cb_product WHERE product_id = #{productId}
		<if test="clientId != null and clientId !=''">
		     AND client_id = #{clientId}
		</if>
		 LIMIT 1
	</select>
	
	<!-- 查询正在审核的临时表中商品信息 -->
	<select id="getAuditingTempProductById" parameterType="Product" resultMap="productTempResultMap">
		SELECT id,client_id,merchant_id,product_id,audit_stage  
		FROM cb_product_temp WHERE product_id = #{productId} AND is_history=false
		<if test="clientId != null and clientId !=''">
		     AND client_id = #{clientId}
		</if>
		 LIMIT 1
	</select>
	
	<!-- 将临时表中的信息同步到Product主表中 -->
	<update id="updateAuditPassProduct" parameterType="ProductTemp">
		UPDATE cb_product 
		<set>
			<if test="rackTime != null">
				 rack_time = #{rackTime}, 
			</if>
			<if test="deliveryOption != null">
				 delivery_option = #{deliveryOption}, 
			</if>
			<if test="name != null">
				 name = #{name}, 
			</if>
			<if test="fullName != null">
				 full_name = #{fullName},
			</if>
			<if test="price != null">
				 price = #{price},
			</if>
			<if test="cost != null">
				 cost = #{cost},
			</if>
			<if test="marketPrice != null">
				 market_price = #{marketPrice},
			</if>
			<if test="isSeckill != null">
				 is_seckill = #{isSeckill},
			</if>
			<if test="isLimit != null">
				 is_limit = #{isLimit},
			</if>
			<if test="briefIntroduction != null">
				 brief_introduction = #{briefIntroduction},
			</if>
			<if test="introduction != null">
				 introduction = #{introduction},
			</if>
			<if test="buyKnow != null">
				 buy_know = #{buyKnow},
			</if>
			<if test="startTime != null">
				 start_time = #{startTime},
			</if>
			<if test="endTime != null">
				 end_time = #{endTime},
			</if>
			<if test="deliveryMoney != null">
				 delivery_money = #{deliveryMoney},
			</if>
			<if test="categoryTreePath != null">
				 category_tree_path = #{categoryTreePath},
			</if>
			<if test="isPoint != null">
				 is_point = #{isPoint},
			</if>
			<if test="vipPrice != null">
				 vip_price = #{vipPrice},
			</if>
			<if test="deliveryTime != null">
				 delivery_time = #{deliveryTime},
			</if>
			<if test="seoKeyWords != null">
				 seo_keyWords = #{seoKeyWords},
			</if>
			<if test="afterShop != null">
				 after_shop = #{afterShop},
			</if>
			<if test="goodFlag != null">
				 good_flag = #{goodFlag},
			</if>
			<if test="weight != null">
				 weight = #{weight},
			</if>
			<if test="weightUnit != null">
				 weight_unit = #{weightUnit},
			</if>
			<if test="orderValue != null">
				 order_value = #{orderValue},
			</if>
			<if test="isBest != null">
				 is_best = #{isBest},
			</if>
		</set>
		 WHERE product_id = #{productId}
		<if test="clientId != null">
			 AND client_id = #{clientId}
		</if>
	</update>
	
	<!-- 将临时表中的信息同步到ProductGroup主表中 -->
	<update id="updateAuditPassProductGroup" parameterType="ProductGroup">
		UPDATE cb_product_group 
		<set>
		<if test="expireStartTime != null">
			 expire_start_time = #{expireStartTime},
		</if>
		<if test="expireEndTime != null">
			 expire_end_time = #{expireEndTime},
		</if>
		</set>
		 WHERE product_id = #{productId}
		<if test="clientId != null">
			 AND client_id = #{clientId}
		</if>
	</update>

	<!-- 将临时表中的信息同步到ProductPresell主表中 -->
	<update id="updateAuditPassProductPresell" parameterType="ProductPresell">
		UPDATE cb_product_presell 
		<set>
			 <if test="expireStartTime != null">
			 	 expire_start_time = #{expireStartTime},
			 </if>
			 <if test="expireEndTime != null">
			 	 expire_end_time = #{expireEndTime},
			 </if>
			 <if test="productSupplier != null">
			 	 product_supplier = #{productSupplier},
			 </if>
			 <if test="maxPerOutlet != null">
			 	 max_per_outlet = #{maxPerOutlet},
			 </if>
			 <if test="deliveryStartTime != null">
			 	 delivery_start_time = #{deliveryStartTime},
			 </if>
			 <if test="deliveryEndTime != null">
			 	 delivery_end_time = #{deliveryEndTime},
			 </if>
			 <if test="clusterState != null">
			 	 cluster_state = #{clusterState},
			 </if>
			 <if test="clusterType != null">
			 	 cluster_type = #{clusterType},
			 </if>
		</set>
		 WHERE product_id = #{productId}
		<if test="clientId != null">
			 AND client_id = #{clientId}
		</if>
	</update>
	
	<!-- 将审核信息更新到临时表中 -->
	<update id="updateTempProduct" parameterType="ProductTemp">
		UPDATE cb_product_temp set audit_comment = #{auditComment}    
			<if test="auditId != null">
				 ,audit_id = #{auditId} 
			</if>
			<if test="auditTime != null">
				 ,audit_time = #{auditTime} 
			</if>
			<if test="auditState != null">
				 ,audit_state = #{auditState}
			</if>
			<if test="auditStage != null">
				 ,audit_stage = #{auditStage}
			</if>
			<if test="reviewStaff != null">
				 ,review_staff = #{reviewStaff}
			</if>
			<if test="auditStaff != null">
				 ,audit_staff = #{auditStaff}
			</if>
			<if test="isMarketable != null">
				 ,is_marketable = #{isMarketable} 
			</if>
			<if test="rackTime != null">
				 ,rack_time = #{rackTime} 
			</if>
			<if test="isHistory != null">
				 ,is_history = #{isHistory} 
			</if>
		 WHERE product_id = #{productId} AND is_history=false
			<if test="clientId != null">
				 AND client_id = #{clientId}
			</if>
	</update>
	
	<!-- 将审核信息更新到product主表中 -->
	<update id="updateAuditingProduct" parameterType="ProductTemp">
		update cb_product set audit_comment = #{auditComment} 
			<if test="auditTime != null">
				 ,audit_time = #{auditTime} 
			</if>
			<if test="auditState != null">
				 ,audit_state = #{auditState}
			</if>
			<if test="auditStage != null">
				 ,audit_stage = #{auditStage}
			</if>
			<if test="reviewStaff != null">
				 ,review_staff = #{reviewStaff}
			</if>
			<if test="auditStaff != null">
				 ,audit_staff = #{auditStaff}
			</if>
			<if test="isMarketable != null">
				 ,is_marketable = #{isMarketable} 
			</if>
			<if test="rackTime != null">
				 ,rack_time = #{rackTime} 
			</if>
		 WHERE product_id = #{productId}
		<if test="clientId != null">
			 AND client_id = #{clientId}
		</if>
	</update>
	
	<!-- 修改了不需要审核字段值更新到Product主表中 -->
	<update id="updateNoNeedAuditProduct" parameterType="ProductTemp">
		UPDATE cb_product 
		<set>
			<if test="store != null">
				 store = #{store},
			</if>
			<if test="endTime != null">
				 end_time = #{endTime},
			</if>
		</set>
		 WHERE product_id = #{productId}
		<if test="clientId != null">
			 AND client_id = #{clientId}
		</if>
	</update>
	
	<!-- 修改了不需要审核字段值更新到ProductGroup主表中 -->
	<update id="updateNoNeedAuditProductGroup" parameterType="ProductTemp">
		UPDATE cb_product_group 
		<set>
		<if test="expireEndTime != null">
			 expire_end_time = #{expireEndTime},
		</if>
		</set>
		 WHERE product_id = #{productId}
		<if test="clientId != null">
			 AND client_id = #{clientId}
		</if>
	</update>

	<!-- 修改了不需要审核字段值更新到临时表中 -->
	<update id="updateNoNeedAuditTempProduct" parameterType="ProductTemp">
		UPDATE cb_product_temp  
		<set>
			<if test="store != null">
				 store = #{store},
			</if>
			<if test="endTime != null">
				 end_time = #{endTime},
			</if>
			<if test="expireEndTime != null">
			 	 expire_end_time = #{expireEndTime},
			 </if>
		</set>
		 WHERE product_id = #{productId} AND is_history=false
			<if test="clientId != null">
				 AND client_id = #{clientId}
			</if>
	</update>
	
	<!-- 更新商品子审核状态 -->
	<update id="updateProductEditAuditStatus" parameterType="Map">
		UPDATE cb_product set edit_audit_state = #{auditState} 
		WHERE product_id = #{productId} 
			<if test="clientId != null">
				 AND client_id = #{clientId}
			</if>
	</update>
	
</mapper>

